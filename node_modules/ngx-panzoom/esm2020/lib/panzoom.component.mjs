import { Component, ViewChild, Input } from '@angular/core';
import * as i0 from "@angular/core";
export class PanZoomComponent {
    constructor(zone) {
        this.zone = zone;
        this.isDragging = false;
        this.lastTick = 0;
        this.isChrome = false;
        this.willChangeNextFrame = true; // used for scaling in Chrome
        this.isMobile = false;
        this.isFirstSync = true;
        this.zoomLevelIsChanging = false;
        this.dragFinishing = false;
        //////////////////////////// END OF LIFECYCLE HOOKS ////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////////// EVENT HANDLERS ///////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////
        this.onMouseWheel = (event) => {
            // console.log('PanZoomComponent: OnMouseWheel() event:', event);
            if (!(event && event.pageX && event.pageY)) {
                return;
            }
            let deltaY = event.deltaY;
            if (this.config.zoomOnMouseWheel) {
                if (this.animationParams) {
                    return; // already zooming
                }
                if (!this.config.invertMouseWheel) {
                    deltaY = -deltaY;
                }
                const frameElementOffset = this.getFrameElementOffset();
                const clickPoint = {
                    x: event.pageX - frameElementOffset.left,
                    y: event.pageY - frameElementOffset.top
                };
                this.lastClickPoint = clickPoint;
                if (this.config.freeMouseWheel) {
                    // free wheel scroll
                    this.freeZoom(clickPoint, deltaY);
                }
                else {
                    if (deltaY < 0) {
                        this.zoomInToPoint(clickPoint);
                    }
                    else if (deltaY > 0) {
                        this.zoomOutFromPoint(clickPoint);
                    }
                }
            }
        };
        this.onMousedown = (event) => {
            // console.log('PanZoomComponent: onMousedown()', event);
            /* Check if clicked location is inside element from which
               dragging is prevented. */
            if (this.config.noDragFromElementClass
                && this.isParentElement(this.config.noDragFromElementClass, event.srcElement)) {
                return;
            }
            if (event.button === this.dragMouseButton || event.type === 'touchstart') {
                if (event.type !== 'touchstart') {
                    event.preventDefault();
                }
                this.dragFinishing = false;
                this.panVelocity = undefined;
                if (this.config.panOnClickDrag) {
                    this.previousPosition = {
                        x: event.pageX,
                        y: event.pageY
                    };
                    this.lastMouseEventTime = event.timeStamp;
                    this.isDragging = true;
                    this.model.isPanning = false;
                    if (this.isMobile) {
                        this.zone.runOutsideAngular(() => document.addEventListener('touchend', this.onTouchEnd, false)); // leave this on document
                        this.zone.runOutsideAngular(() => document.addEventListener('touchmove', this.onTouchMove, { passive: true, capture: false })); // leave this on document
                    }
                    else {
                        this.zone.runOutsideAngular(() => document.addEventListener('mousemove', this.onMouseMove, { passive: true, capture: false })); // leave this on document
                        this.zone.runOutsideAngular(() => document.addEventListener('mouseup', this.onMouseUp)); // leave this on document
                    }
                }
                return false;
            }
        };
        this.onTouchStart = (event) => {
            // console.log('PanZoomComponent: onTouchStart()', event);
            // console.log('PanZoomComponent: onTouchStart(): touches:', event.touches.length);
            //event.preventDefault();
            if (event.touches.length !== 1) {
                // multiple touches, get ready for zooming
                // Calculate x and y distance between touch events
                const x = event.touches[0].pageX - event.touches[1].pageX;
                const y = event.touches[0].pageY - event.touches[1].pageY;
                // Calculate length between touch points with pythagoras
                // There is no reason to use Math.pow and Math.sqrt as we
                // only want a relative length and not the exact one.
                this.previousPosition = {
                    length: x * x + y * y
                };
            }
            this.onMousedown(event);
        };
        this.onMouseMove = (event) => {
            // console.log('PanZoomComponent: onMouseMove()', event);
            // console.log(`PanZoomComponent: onMouseMove(): event.timeStamp:`, event.timeStamp);
            // timestamp - 10587.879999999132 - milliseconds
            // Called when moving the mouse with the left button down
            let evWrap;
            if (event && event.pageX && event.pageY) {
                evWrap = event;
            }
            else if ((event.type === 'touchmove') && event.touches[0].pageX && event.touches[0].pageY) {
                evWrap = {
                    pageX: event.touches[0].pageX,
                    pageY: event.touches[0].pageY
                };
            }
            else {
                return;
            }
            const now = event.timeStamp;
            const timeSinceLastMouseEvent = (now - this.lastMouseEventTime) / 1000;
            this.lastMouseEventTime = now;
            const dragDelta = {
                // a representation of how far each coordinate has moved since the last time it was moved
                x: evWrap.pageX - this.previousPosition.x,
                y: evWrap.pageY - this.previousPosition.y
            };
            if (this.config.keepInBounds) {
                const topLeftCornerView = this.getViewPosition({ x: 0, y: 0 });
                const bottomRightCornerView = this.getViewPosition({ x: this.contentWidth, y: this.contentHeight });
                if (topLeftCornerView.x > 0 && dragDelta.x > 0) {
                    dragDelta.x *= Math.min(1, Math.pow(topLeftCornerView.x, -this.config.keepInBoundsDragPullback));
                }
                if (topLeftCornerView.y > 0 && dragDelta.y > 0) {
                    dragDelta.y *= Math.min(1, Math.pow(topLeftCornerView.y, -this.config.keepInBoundsDragPullback));
                }
                if (bottomRightCornerView.x < this.contentWidth && dragDelta.x < 0) {
                    dragDelta.x *= Math.min(1, Math.pow(this.contentWidth - bottomRightCornerView.x, -this.config.keepInBoundsDragPullback));
                }
                if (bottomRightCornerView.y < this.contentHeight && dragDelta.y < 0) {
                    dragDelta.y *= Math.min(1, Math.pow(this.contentHeight - bottomRightCornerView.y, -this.config.keepInBoundsDragPullback));
                }
            }
            // now pan the view
            const delta = {
                x: dragDelta.x || 0,
                y: dragDelta.y || 0
            };
            this.model.pan.x += delta.x;
            this.model.pan.y += delta.y;
            this.syncBaseToModel();
            this.animationTick();
            if (!this.model.isPanning) {
                // This will improve the performance,
                // because the browser stops evaluating hits against the elements displayed inside the pan zoom view.
                // Besides this, mouse events will not be sent to any other elements,
                // this prevents issues like selecting elements while dragging.
                this.panzoomOverlayRef.nativeElement.style.display = 'block';
            }
            this.model.isPanning = true;
            // set these for the animation slow down once drag stops
            // panVelocity is a measurement of speed for x and y coordinates, in pixels per mouse move event.  It is a measure of how fast the mouse is moving
            const panVelocityX = dragDelta.x / timeSinceLastMouseEvent;
            const panVelocityY = dragDelta.y / timeSinceLastMouseEvent;
            this.panVelocity = {
                x: !Number.isFinite(panVelocityX) ? 0 : panVelocityX,
                y: !Number.isFinite(panVelocityY) ? 0 : panVelocityY
            };
            // console.log(`PanZoomComponent: onMouseMove(): panVelocity:`, this.panVelocity);
            this.previousPosition = {
                x: evWrap.pageX,
                y: evWrap.pageY
            };
        };
        this.onTouchMove = (event) => {
            // console.log('PanZoomComponent: onTouchMove()');
            // console.log('PanZoomComponent: onTouchMove(): event:', event);
            if (event.touches.length === 1) {
                // single touch, emulate mouse move
                this.onMouseMove(event);
            }
            else {
                // multiple touches, zoom in/out
                // console.log('pinch zooming');
                // Calculate x and y distance between touch events
                const x = event.touches[0].pageX - event.touches[1].pageX;
                const y = event.touches[0].pageY - event.touches[1].pageY;
                // Calculate length between touch points with pythagoras
                // There is no reason to use Math.pow and Math.sqrt as we
                // only want a relative length and not the exact one.
                const length = x * x + y * y;
                // Calculate delta between current position and last position
                const delta = length - this.previousPosition.length;
                // Naive hysteresis
                if (Math.abs(delta) < 100) {
                    return;
                }
                // Calculate center between touch points
                const centerX = event.touches[1].pageX + x / 2;
                const centerY = event.touches[1].pageY + y / 2;
                // Calculate zoom center
                const frameElementOffset = this.getFrameElementOffset();
                const clickPoint = {
                    x: centerX - frameElementOffset.left,
                    y: centerY - frameElementOffset.top
                };
                this.lastClickPoint = clickPoint;
                this.changeZoomLevel(this.base.zoomLevel + delta * 0.0001, clickPoint);
                // Update length for next move event
                this.previousPosition = {
                    length: length
                };
            }
        };
        this.onMouseUp = (event) => {
            // console.log('PanZoomComponent: onMouseup()', event);
            if ((event.button !== this.dragMouseButton) && (event.type !== 'touchend')) {
                return;
            }
            if (event.type !== 'touchend') {
                event.preventDefault();
            }
            const now = event.timeStamp;
            const timeSinceLastMouseEvent = (now - this.lastMouseEventTime) / 1000;
            if (this.panVelocity && (this.panVelocity.x !== 0 || this.panVelocity.y !== 0)) {
                // apply strong initial dampening if the mouse up occured much later than the last mouse move, indicating that the mouse hasn't moved recently
                // TBD - experiment with this formula
                const initialMultiplier = Math.max(0, -0.2 + Math.pow(timeSinceLastMouseEvent + 1, -4));
                this.panVelocity.x *= initialMultiplier;
                this.panVelocity.y *= initialMultiplier;
                this.dragFinishing = true;
                this.zone.runOutsideAngular(() => this.animationId = this.animationFrameFunc(this.animationTick));
            }
            else {
                this.panVelocity = undefined;
                this.dragFinishing = false;
                this.model.isPanning = false;
                this.config.modelChanged.next(this.model);
                this.syncBaseToModel();
            }
            this.isDragging = false;
            if (this.isMobile) {
                this.zone.runOutsideAngular(() => document.removeEventListener('touchend', this.onTouchEnd));
                this.zone.runOutsideAngular(() => document.removeEventListener('touchmove', this.onTouchMove, { passive: true, capture: false }));
            }
            else {
                this.zone.runOutsideAngular(() => document.removeEventListener('mousemove', this.onMouseMove, { passive: true, capture: false }));
                this.zone.runOutsideAngular(() => document.removeEventListener('mouseup', this.onMouseUp, { passive: true }));
            }
            // Set the overlay to non-blocking again:
            this.panzoomOverlayRef.nativeElement.style.display = 'none';
        };
        this.onTouchEnd = (event) => {
            // console.log('PanZoomComponent: onTouchEnd()');
            this.onMouseUp(event);
        };
        this.onDblClick = (event) => {
            // console.log('PanZoomComponent: onDblClick()');
            event.preventDefault();
            if (!this.config.zoomOnDoubleClick) {
                return;
            }
            const frameElementOffset = this.getFrameElementOffset();
            const clickPoint = {
                x: event.pageX - frameElementOffset.left,
                y: event.pageY - frameElementOffset.top
            };
            this.lastClickPoint = clickPoint;
            this.zoomInToPoint(clickPoint);
        };
        this.preventDefault = (event) => {
            event.preventDefault();
        };
        ////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////// END EVENT HANDLERS ///////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////// APPLY ANIMATIONS /////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////
        this.animationTick = (timestamp = performance.now()) => {
            // console.log('PanZoomComponent: animationTick()');
            // timestamp looks like 76916.963.  The unit is milliseconds and should be accurate to 5 µs (microseconds)
            let deltaTime = 0;
            if (this.lastTick !== 0) {
                deltaTime = (timestamp - this.lastTick); // orig - milliseconds since the last animationTick
            }
            this.lastTick = timestamp;
            if (this.animationParams) {
                // when we're running an animation (but not waiting for a released drag to halt)
                // console.log('PanZoomComponent: animationTick(): model is zooming');
                this.animationParams.progress += Math.abs(deltaTime / this.animationParams.duration);
                if (this.animationParams.progress >= 1.0) {
                    // Only when the animation has finished, sync the base to the model.
                    this.animationParams.progress = 1.0;
                    this.updateDOM();
                    this.animationParams = undefined;
                }
            }
            if (this.panVelocity && this.dragFinishing) {
                // This is when we've panned and released the mouse button and the view is "free-floating" until it slows to a halt.  Don't let the while loop fool you - this only applies it for the current frame.
                // Prevent overshooting if delta time is large for some reason. We apply the simple solution of slicing delta time into smaller pieces and applying each one
                if (deltaTime > 0) {
                    deltaTime = deltaTime / 1000;
                }
                while (deltaTime > 0) {
                    const dTime = Math.min(.02, deltaTime);
                    deltaTime = deltaTime - dTime;
                    this.model.pan.x = this.model.pan.x + this.panVelocity.x * dTime;
                    this.panVelocity.x = this.panVelocity.x * (1 - this.config.friction * dTime);
                    this.model.pan.y = this.model.pan.y + this.panVelocity.y * dTime;
                    this.panVelocity.y = this.panVelocity.y * (1 - this.config.friction * dTime);
                    const speed = this.length(this.panVelocity);
                    if (speed <= this.config.haltSpeed) {
                        this.panVelocity = undefined;
                        this.dragFinishing = false;
                        break;
                    }
                }
            }
            if (this.config.keepInBounds || this.dragFinishing) {
                // Checks that keepInBounds is set and that the mouse button isn't pressed, and if so, it stops the contents from going out of view
                // console.log('PanZoomComponent: animationTick(): keepInBounds');
                const topLeftCornerView = this.getViewPosition({ x: 0, y: 0 });
                const bottomRightCornerView = this.getViewPosition({ x: this.contentWidth, y: this.contentHeight });
                if (topLeftCornerView.x > 0) {
                    this.base.pan.x -= this.config.keepInBoundsRestoreForce * topLeftCornerView.x;
                }
                if (topLeftCornerView.y > 0) {
                    this.base.pan.y -= this.config.keepInBoundsRestoreForce * topLeftCornerView.y;
                }
                if (bottomRightCornerView.x < this.contentWidth) {
                    this.base.pan.x -= this.config.keepInBoundsRestoreForce * (bottomRightCornerView.x - this.contentWidth);
                }
                if (bottomRightCornerView.y < this.contentHeight) {
                    this.base.pan.y -= this.config.keepInBoundsRestoreForce * (bottomRightCornerView.y - this.contentHeight);
                }
            }
            this.updateDOM();
            this.config.modelChanged.next(this.model);
            if (this.animationParams || (this.panVelocity && this.dragFinishing)) {
                // Is an animation active?  If so, run the next frame
                if (this.isChrome && this.zoomLevelIsChanging) {
                    // run will-change toggle hack on Chrome to trigger re-rasterization
                    // see https://developers.google.com/web/updates/2016/09/re-rastering-composite
                    if (this.willChangeNextFrame) {
                        this.zoomElementRef.nativeElement.style.willChange = 'auto';
                    }
                    else {
                        this.zoomElementRef.nativeElement.style.willChange = 'transform';
                    }
                    this.willChangeNextFrame = !this.willChangeNextFrame;
                }
                this.animationFrameFunc(this.animationTick); // Call the next animation frame
            }
            else if (this.panVelocity && !this.dragFinishing) {
                // we're just mouse-panning the frame.  We don't need another tick
                return;
            }
            else {
                // Animation has ended
                if (this.model.isPanning) {
                    this.model.isPanning = false;
                }
                this.syncBaseToModel();
                this.config.modelChanged.next(this.model);
                this.scale = this.getCssScale(this.base.zoomLevel);
                this.willChangeNextFrame = true;
                this.zoomElementRef.nativeElement.style.willChange = 'transform';
                this.zoomLevelIsChanging = false;
                this.lastTick = 0;
            }
        };
    }
    ngOnInit() {
        // console.log('PanZoomComponent: ngOnInit(): initializing PanZoomComponent');
        if (this.config.initialZoomToFit) {
            this.base = this.calcZoomToFit(this.config.initialZoomToFit);
        }
        else {
            this.base = {
                zoomLevel: this.config.initialZoomLevel,
                pan: {
                    x: this.config.initialPanX,
                    y: this.config.initialPanY
                }
            };
        }
        this.model = {
            zoomLevel: this.base.zoomLevel,
            isPanning: false,
            pan: {
                x: this.base.pan.x,
                y: this.base.pan.y
            }
        };
        this.config.modelChanged.next(this.model);
        // create public API
        this.api = {
            model: this.model,
            config: this.config,
            changeZoomLevel: this.zoomToLevelAndPoint.bind(this),
            zoomIn: this.zoomIn.bind(this),
            zoomOut: this.zoomOut.bind(this),
            zoomToFit: this.zoomToFit.bind(this),
            resetView: this.resetView.bind(this),
            getViewPosition: this.getViewPosition.bind(this),
            getModelPosition: this.getModelPosition.bind(this),
            panToPoint: this.panToPoint.bind(this),
            panDelta: this.panDelta.bind(this),
            panDeltaPercent: this.panDeltaPercent.bind(this),
            panDeltaAbsolute: this.panDeltaAbsolute.bind(this),
            centerContent: this.centerContent.bind(this),
            centerX: this.centerX.bind(this),
            centerY: this.centerY.bind(this),
            centerTopLeft: this.centerTopLeftCorner.bind(this),
            centerBottomLeft: this.centerBottomLeftCorner.bind(this),
            centerTopRight: this.centerTopRightCorner.bind(this),
            centerBottomRight: this.centerBottomRightCorner.bind(this),
            updateContentDimensions: this.updateContentDimensions.bind(this),
            detectContentDimensions: this.detectContentDimensions.bind(this)
        };
        this.config.api.next(this.api);
        if (this.config.freeMouseWheel) {
            this.scale = this.getCssScale(this.config.initialZoomLevel);
            const maxZoomLevel = this.config.zoomLevels - 1;
            this.maxScale = this.getCssScale(maxZoomLevel);
            this.minScale = this.getCssScale(0);
        }
        this.minimumAllowedZoomLevel = 0;
        if (this.config.keepInBounds) {
            this.minimumAllowedZoomLevel = this.config.neutralZoomLevel;
            this.minScale = this.getCssScale(this.config.neutralZoomLevel);
        }
        this.zoomElementRef.nativeElement.style.willChange = 'transform';
        if (navigator.userAgent.search('Chrome') >= 0) {
            this.isChrome = true;
            this.zoomElementRef.nativeElement.style.transform = 'translateZ(0)';
        }
        if (this.config.acceleratePan) {
            this.panElementRef.nativeElement.style.willChange = 'transform';
            if (navigator.userAgent.search('Chrome') >= 0) {
                this.isChrome = true;
                this.panElementRef.nativeElement.style.transform = 'translateZ(0)';
            }
        }
        this.animationTick();
        this.scale = this.getCssScale(this.base.zoomLevel);
        this.isFirstSync = false;
        switch (this.config.dragMouseButton) {
            case 'left':
                this.dragMouseButton = 0;
                break;
            case 'middle':
                this.dragMouseButton = 1;
                this.zone.runOutsideAngular(() => this.frameElementRef.nativeElement.addEventListener('auxclick', this.preventDefault));
                break;
            case 'right':
                this.zone.runOutsideAngular(() => document.addEventListener('contextmenu', this.preventDefault));
                this.dragMouseButton = 2;
                break;
            default:
                this.dragMouseButton = 0; // left
        }
    }
    ngAfterViewInit() {
        // console.log('PanZoomComponent: ngAfterViewInit()');
        this.detectContentDimensions();
        const frameStyle = getComputedStyle(this.frameElementRef.nativeElement);
        this.frameHeight = parseInt(frameStyle.getPropertyValue('height').split('px')[0]);
        this.frameWidth = parseInt(frameStyle.getPropertyValue('width').split('px')[0]);
        this.zone.runOutsideAngular(() => this.animationFrameFunc = window.requestAnimationFrame);
        if (this.config.dynamicContentDimensions) {
            if (window.ResizeObserver) {
                this.resizeObserver = new window.ResizeObserver(entries => this.onContentDimensionsChangeDetected(entries));
                this.zone.runOutsideAngular(() => this.resizeObserver.observe(this.zoomElementRef.nativeElement));
            }
            else {
                console.error('ResizeObserver API is not supported by this browser.  See https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver for info on browser compatibility.');
            }
        }
        if (this.isMobileDevice()) {
            this.isMobile = true;
            this.zone.runOutsideAngular(() => this.frameElementRef.nativeElement.addEventListener('touchstart', this.onTouchStart));
        }
        else {
            this.zone.runOutsideAngular(() => {
                this.frameElementRef.nativeElement.addEventListener('mousedown', this.onMousedown);
                this.frameElementRef.nativeElement.addEventListener('dblclick', this.onDblClick);
                this.frameElementRef.nativeElement.addEventListener('wheel', (event) => this.animationFrameFunc(() => this.onMouseWheel(event)), { passive: true });
            });
        }
    }
    ngOnDestroy() {
        // console.log('PanZoomComponent: ngOnDestroy()');
        if (this.isMobile) {
            this.frameElementRef.nativeElement.removeEventListener('touchstart', this.onTouchStart);
        }
        else {
            this.frameElementRef.nativeElement.removeEventListener('mousedown', this.onMousedown);
            this.frameElementRef.nativeElement.removeEventListener('wheel', (event) => this.animationFrameFunc(() => this.onMouseWheel(event)), { passive: true });
            this.frameElementRef.nativeElement.removeEventListener('dblclick', this.onDblClick);
        }
        if (this.animationFrameFunc && this.animationId) {
            window.cancelAnimationFrame(this.animationId);
        }
        if (this.resizeObserver) {
            this.resizeObserver.disconnect();
        }
        switch (this.config.dragMouseButton) {
            case 'middle':
                this.dragMouseButton = 1;
                this.zone.runOutsideAngular(() => this.frameElementRef.nativeElement.removeEventListener('auxclick', this.preventDefault));
                break;
            case 'right':
                this.zone.runOutsideAngular(() => document.removeEventListener('contextmenu', this.preventDefault));
                this.dragMouseButton = 2;
                break;
        }
    }
    /**
     * Method will check if 'child' node element is a child of
     * parent node with class 'className'
     * @param className
     * @param child
     */
    isParentElement(className, child) {
        let node = child.parentNode;
        while (node !== null) {
            if (node.classList && node.classList.contains(className)) {
                return true;
            }
            node = node.parentNode;
        }
        return false;
    }
    updateDOM() {
        // console.log('PanZoomComponent: updateDOM()');
        // Called by ngAfterViewInit() and animationTick()
        // This function does not get called by freeZoom(), which operates independently of animationTick() and updateDOM().
        if (this.animationParams) {
            // we're running an animation sequence (but not freeZooming or panning with onMouseMove() )
            this.model.zoomLevel = this.base.zoomLevel + this.animationParams.deltaZoomLevel * this.animationParams.progress; // calculate how far we need to zoom in or out for the current animationTick
            const deltaTranslation = this.animationParams.panStepFunc(this.model.zoomLevel); // calculate how far to pan the view to based on our translated coordinates
            // sync the model pan coordinates to our translated pan coordinates
            // we do this by adding how far we want to move in each direction to our our existing base pan coordinates (where we started)
            this.model.pan.x = this.base.pan.x + deltaTranslation.x;
            this.model.pan.y = this.base.pan.y + deltaTranslation.y;
            if (this.config.keepInBounds) {
                const topLeftCornerView = this.getViewPosition({ x: 0, y: 0 });
                const bottomRightCornerView = this.getViewPosition({ x: this.contentWidth, y: this.contentHeight });
                if (topLeftCornerView.x > 0) {
                    this.model.pan.x = 0;
                }
                if (topLeftCornerView.y > 0) {
                    this.model.pan.y = 0;
                }
                if (bottomRightCornerView.x < this.contentWidth) {
                    this.model.pan.x -= (bottomRightCornerView.x - this.contentWidth);
                }
                if (bottomRightCornerView.y < this.contentHeight) {
                    this.model.pan.y -= (bottomRightCornerView.y - this.contentHeight);
                }
            }
        }
        ////////////////////////////////////////////////////
        //////////////////// APPLY SCALING /////////////////
        ////////////////////////////////////////////////////
        if (this.animationParams || this.isFirstSync) {
            const scale = this.getCssScale(this.model.zoomLevel);
            const scaleString = `scale(${scale})`;
            const zoomStyle = `transform-origin: 0 0; transform: ${scaleString};`;
            this.zoomElementRef.nativeElement.setAttribute('style', zoomStyle);
        }
        ////////////////////////////////////////////////////
        //////////////// APPLY PAN ANIMATION ///////////////
        ////////////////////////////////////////////////////
        const translate3d = `translate3d(${this.model.pan.x}px, ${this.model.pan.y}px, 0)`;
        this.panElementRef.nativeElement.style.transform = translate3d;
    }
    freeZoom(clickPoint, wheelDelta) {
        // console.log('PanZoomComponent: freeZoom(): this.base:', this.base);
        if (this.isDragging) {
            // don't allow zooming if the mouse is down
            return;
        }
        // now handle interruption of an in-progress animation
        if (this.animationParams) {
            this.animationParams = undefined; // cancel an existing animation
        }
        if (this.panVelocity) {
            this.dragFinishing = false;
            this.panVelocity = undefined;
        }
        const currentPan = {
            // the current model coordinates
            x: this.model.pan.x,
            y: this.model.pan.y
        };
        const currentScale = this.scale; // get the current CSS scale (scale0)
        let newScale = this.scale + (wheelDelta * this.config.freeMouseWheelFactor * this.scale);
        // takes either the minimum scale (furthest allowable zoomed out) or the calculated current scale, whichever is greater, unless calculated current scale exceeds maxScale (furthest allowable zoomed in), in which case maxScale is used
        newScale = Math.max(this.minScale, Math.min(this.maxScale, newScale));
        this.scale = newScale;
        const targetPoint = {
            // The target point to zoom to.  It must stay the same as the untranslated point
            x: clickPoint.x - (newScale / currentScale) * (clickPoint.x - currentPan.x),
            y: clickPoint.y - (newScale / currentScale) * (clickPoint.y - currentPan.y)
        };
        // Apply Pan & Scale
        const translate3d = `translate3d(${targetPoint.x}px, ${targetPoint.y}px, 0)`;
        this.panElementRef.nativeElement.style.transform = translate3d;
        const scaleString = `scale(${this.scale})`;
        let zoomStyle = `transform-origin: 0 0; transform: ${scaleString};`;
        if (this.isChrome) {
            if (this.willChangeNextFrame) {
                zoomStyle += ` will-change: auto;`;
            }
            else {
                zoomStyle += ` will-change: transform;`;
            }
            this.willChangeNextFrame = !this.willChangeNextFrame;
        }
        // apply zoom css
        this.zoomElementRef.nativeElement.setAttribute('style', zoomStyle);
        this.model.pan.x = targetPoint.x;
        this.model.pan.y = targetPoint.y;
        this.model.zoomLevel = this.getZoomLevel(this.scale);
        this.config.modelChanged.next(this.model);
        this.syncBaseToModel();
    }
    ////////////////////////////////////////////////////
    //////////////// HELPER FUNCTIONS //////////////////
    ////////////////////////////////////////////////////
    isMobileDevice() {
        return (typeof window.orientation !== 'undefined') || (navigator.userAgent.indexOf('IEMobile') !== -1);
    }
    syncBaseToModel() {
        this.base.pan.x = this.model.pan.x;
        this.base.pan.y = this.model.pan.y;
        this.base.zoomLevel = this.model.zoomLevel;
    }
    length(vector2d) {
        // console.log('PanZoomComponent: length()');
        return Math.sqrt(vector2d.x * vector2d.x + vector2d.y * vector2d.y);
    }
    getCentrePoint() {
        // console.log('PanZoomComponent: getCentrePoint()');
        return {
            x: this.frameElementRef.nativeElement.offsetWidth / 2,
            y: this.frameElementRef.nativeElement.offsetHeight / 2
        };
    }
    getCssScale(zoomLevel) {
        // console.log('PanZoomComponent: getCssScale()');
        return Math.pow(this.config.scalePerZoomLevel, zoomLevel - this.config.neutralZoomLevel);
    }
    getZoomLevel(cssScale) {
        // console.log('PanZoomComponent: getZoomLevel()');
        return Math.log10(cssScale) / Math.log10(this.config.scalePerZoomLevel) + this.config.neutralZoomLevel;
    }
    calcZoomToFit(rect) {
        // console.log('PanZoomComponent: calcZoomToFit(): rect:', rect);
        // let (W, H) denote the size of the viewport
        // let (w, h) denote the size of the rectangle to zoom to
        // then we must CSS scale by the min of W/w and H/h in order to just fit the rectangle
        // returns the target left and top coordinates for the panElement and target zoomLevel
        const viewportWidth = this.frameElementRef.nativeElement.offsetWidth;
        const viewportHeight = this.frameElementRef.nativeElement.offsetHeight;
        const targetWidth = rect.width;
        const targetHeight = rect.height;
        const cssScaleExact = Math.min(viewportWidth / targetWidth, viewportHeight / targetHeight);
        const zoomLevelExact = this.getZoomLevel(cssScaleExact);
        const zoomLevel = zoomLevelExact * this.config.zoomToFitZoomLevelFactor;
        const cssScale = this.getCssScale(zoomLevel);
        return {
            zoomLevel: zoomLevel,
            pan: {
                x: -rect.x * cssScale + (viewportWidth - targetWidth * cssScale) / 2,
                y: -rect.y * cssScale + (viewportHeight - targetHeight * cssScale) / 2
            }
        };
    }
    zoomToFitModel(target, duration = undefined) {
        // console.log('PanZoomComponent: zoomToFitModel(): target:', target);
        // target.pan.x is the panElement left style property
        // target.pan.y is the panElement top style property
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    zoomToLevelAndPoint(level, clickPoint) {
        // console.log('PanZoomComponent: zoomToLevelAndPoint(): level:', level);
        // console.log('PanZoomComponent: zoomToLevelAndPoint(): clickPoint:', clickPoint);
        this.changeZoomLevel(level, clickPoint);
    }
    zoomIn(zoomType = 'lastPoint') {
        // console.log('PanZoomComponent: zoomIn()');
        if (zoomType === 'lastPoint') {
            this.changeZoomLevel(this.base.zoomLevel + this.config.zoomButtonIncrement, this.lastClickPoint);
        }
        else if (zoomType === 'viewCenter') {
            this.changeZoomLevel(this.base.zoomLevel + this.config.zoomButtonIncrement, this.getCentrePoint());
        }
    }
    zoomOut(zoomType = 'lastPoint') {
        // console.log('PanZoomComponent: zoomOut()');
        if (zoomType === 'lastPoint') {
            this.changeZoomLevel(this.base.zoomLevel - this.config.zoomButtonIncrement, this.lastClickPoint);
        }
        else if (zoomType === 'viewCenter') {
            this.changeZoomLevel(this.base.zoomLevel - this.config.zoomButtonIncrement, this.getCentrePoint());
        }
    }
    startAnimation() {
        this.lastTick = performance.now();
        this.zone.runOutsideAngular(() => this.animationId = this.animationFrameFunc(this.animationTick));
    }
    getFrameElementOffset() {
        const rect = this.frameElementRef.nativeElement.getBoundingClientRect();
        return {
            top: rect.top + window.scrollY,
            left: rect.left + window.scrollX
        };
    }
    onContentDimensionsChangeDetected(entries) {
        // callback for ResizeObserver
        this.contentHeight = entries[0].contentRect.height;
        this.contentWidth = entries[0].contentRect.width;
    }
    ////////////////////////////////////////////////////
    /////////////////// API METHODS ////////////////////
    ////////////////////////////////////////////////////
    getViewPosition(modelPosition) {
        // console.log('PanZoomComponent: getViewPosition()');
        // p' = p * s + t
        // viewPosition = modelPosition * scale + basePan
        let scale, translation;
        if (this.animationParams) {
            scale = this.getCssScale(this.base.zoomLevel + this.animationParams.deltaZoomLevel * this.animationParams.progress);
            let deltaTranslation = this.animationParams.panStepFunc(this.model.zoomLevel);
            translation = {
                x: this.base.pan.x + deltaTranslation.x,
                y: this.base.pan.y + deltaTranslation.y
            };
        }
        else {
            scale = this.getCssScale(this.base.zoomLevel);
            translation = this.base.pan;
        }
        return {
            x: modelPosition.x * scale + translation.x,
            y: modelPosition.y * scale + translation.y
        };
    }
    getModelPosition(viewPosition) {
        // console.log('PanZoomComponent: getModelPosition()');
        // p = (1/s)(p' - t)
        const pmark = viewPosition;
        const s = this.getCssScale(this.base.zoomLevel);
        const t = this.base.pan;
        return {
            x: (1 / s) * (pmark.x - t.x),
            y: (1 / s) * (pmark.y - t.y)
        };
    }
    resetView() {
        // console.log('PanZoomComponent: resetView()');
        if (this.config.initialZoomToFit) {
            this.zoomToFit(this.config.initialZoomToFit);
        }
        else if (this.config.initialPanX !== undefined && this.config.initialPanY !== undefined && this.config.initialZoomLevel !== undefined) {
            this.zoomToFitModel({
                zoomLevel: this.config.initialZoomLevel,
                pan: {
                    x: this.config.initialPanX,
                    y: this.config.initialPanY
                }
            });
        }
        else {
            console.error('PanZoomComponent: resetView() could not reset view as some vars were not set.  The culprits are either config.initialZoomLevel, config.initialPanX, or config.initialPanY.  Or just set panzoomConfig.initialZoomToFit');
            console.log('config.initialZoomLevel: ' + this.config.initialZoomLevel);
            console.log('config.initialPanX: ' + this.config.initialPanX);
            console.log('config.initialPanY: ' + this.config.initialPanY);
        }
    }
    zoomToFit(rectangle, duration) {
        // console.log('PanZoomComponent: zoomToFit(): rectangle', rectangle);
        // when a user clicks a zoom to fit button
        // example rectangle: { "x": 0, "y": 100, "width": 100, "height": 100 }
        const target = this.calcZoomToFit(rectangle);
        // target.pan.x is the panElement left style property
        // target.pan.y is the panElement top style property
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    zoomInToPoint(clickPoint) {
        // console.log('PanZoomComponent: zoomIn(): clickPoint:', clickPoint);
        this.changeZoomLevel(this.base.zoomLevel + this.config.zoomButtonIncrement, clickPoint);
    }
    zoomOutFromPoint(clickPoint) {
        // console.log('PanZoomComponent: zoomOut()');
        this.changeZoomLevel(this.base.zoomLevel - this.config.zoomButtonIncrement, clickPoint);
    }
    panToPoint(point, duration) {
        // console.log('PanZoomComponent: panToPoint(): point:', point);
        // API call to animate the view so that the centre point of the view is at the
        // point parameter coordinates, relative to the original, unzoomed
        // content width and height
        // example point: { "x": 0, "y": 0 } // makes the top-left corner of the content
        // the centre of the view
        const target = {
            pan: {
                x: (this.frameWidth / 2) - point.x * this.scale,
                y: (this.frameHeight / 2) - point.y * this.scale
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    panToPointCurrentScale(point, duration) {
        // console.log('PanZoomComponent: panToPoint(): point:', point);
        // API call to animate the view so that the centre point of the view is at the
        // point parameter coordinates, relative to the original, unzoomed
        // content width and height
        // example point: { "x": 0, "y": 0 } // makes the top-left corner of the content
        // the centre of the view
        const target = {
            pan: {
                x: (this.frameWidth / 2) - point.x,
                y: (this.frameHeight / 2) - point.y
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    panDelta(delta, duration) {
        // console.log('PanZoomComponent: panDelta(): delta:', delta);
        // API call to pan the view left, right, up, or down, based on a number of pixels
        // of the original, unzoomed content.
        // Positive is right and down
        // Negative is left and up
        // example point: { "x": 100, "y": -50 } // moves the view right 50px and up 50px
        const target = {
            pan: {
                x: this.base.pan.x - this.scale * delta.x,
                y: this.base.pan.y - this.scale * delta.y
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    panDeltaAbsolute(delta, duration) {
        // console.log('PanZoomComponent: panDeltaAbsolute(): delta:', delta);
        // API call to pan the view left, right, up, or down, based on a number of pixels
        // This method doesn't adjust for scale.  I'm not sure why you'd want this
        // but have it here just in case someone needs it
        // Positive is right and down
        // Negative is left and up
        // example point: { "x": 100, "y": -50 } // moves the view right 50px and up 50px
        const target = {
            pan: {
                x: this.base.pan.x - delta.x,
                y: this.base.pan.y - delta.y
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    panDeltaPercent(deltaPercent, duration) {
        // console.log('PanZoomComponent: panDeltaPercent(): deltaPercent:', deltaPercent);
        // API call to pan the view up, down, left, or right, based on a percentage
        // of the original, unzoomed content width and height
        // example point: { "x": 10, "y": -20 }
        let deltaX = 0;
        let deltaY = 0;
        if (deltaPercent.x !== 0) {
            deltaX = this.contentWidth * (deltaPercent.x / 100) * this.scale;
        }
        if (deltaPercent.y !== 0) {
            deltaY = this.contentHeight * (deltaPercent.y / 100) * this.scale;
        }
        const target = {
            pan: {
                x: this.base.pan.x - deltaX,
                y: this.base.pan.y - deltaY
            },
            zoomLevel: this.base.zoomLevel
        };
        // target.pan.x is the panElement left style property
        // target.pan.y is the panElement top style property
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    centerContent(duration) {
        this.panToPoint({
            x: this.contentWidth / 2,
            y: this.contentHeight / 2
        }, duration);
    }
    centerX(duration) {
        const target = {
            pan: {
                x: (this.frameWidth / 2) - (this.contentWidth / 2) * this.scale,
                y: this.base.pan.y
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    centerY(duration) {
        const target = {
            pan: {
                x: this.base.pan.x,
                y: (this.frameHeight / 2) - (this.contentHeight / 2) * this.scale
            },
            zoomLevel: this.base.zoomLevel
        };
        this.model.isPanning = true;
        this.animateToTarget(target, duration);
    }
    centerTopLeftCorner(duration) {
        this.panToPoint({
            x: 0,
            y: 0
        }, duration);
    }
    centerBottomLeftCorner(duration) {
        this.panToPoint({
            x: 0,
            y: this.contentHeight
        }, duration);
    }
    centerTopRightCorner(duration) {
        this.panToPoint({
            x: this.contentWidth,
            y: 0
        }, duration);
    }
    centerBottomRightCorner(duration) {
        this.panToPoint({
            x: this.contentWidth,
            y: this.contentHeight
        }, duration);
    }
    updateContentDimensions(width, height) {
        if (height !== undefined) {
            this.contentHeight = height;
        }
        if (width !== undefined) {
            this.contentWidth = width;
        }
    }
    detectContentDimensions() {
        const zoomFrameStyle = getComputedStyle(this.zoomElementRef.nativeElement);
        this.contentHeight = parseInt(zoomFrameStyle.getPropertyValue('height').split('px')[0]);
        this.contentWidth = parseInt(zoomFrameStyle.getPropertyValue('width').split('px')[0]);
    }
    ////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////// ANIMATION BUILDERS ///////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////
    animateToTarget(targetModel, duration = undefined) {
        // console.log('PanZoomComponent: animateToTarget()');
        // what this function really does is take a target model, and then sets
        // this.animationParams with the parameters for the whole animation,
        // namely the delta zoomLevel
        // it is the responsibility of the caller to kick off the animation with a call to animationFrameFunc()
        if (this.animationParams) {
            // make the user wait for existing animation to finish before clicking
            return;
        }
        this.zoomLevelIsChanging = false;
        if (this.base.zoomLevel !== targetModel.zoomLevel) {
            this.zoomLevelIsChanging = true;
        }
        const deltaZoomLevel = targetModel.zoomLevel - this.base.zoomLevel; // deltaZoomLevel is the number of zoom levels we are changing here
        const oldBase = {
            // the current base coordinates
            x: this.base.pan.x,
            y: this.base.pan.y
        };
        this.model.pan.x = this.base.pan.x;
        this.model.pan.y = this.base.pan.y;
        const panStepFunc = (zoomLevel) => {
            // this function gets called during every animation tick in updateDOM(), to calculate where to move the model pan coordinates to (i.e. the translation) for that tick, zoomLevel is ignored within animateToTarget()
            const targetPoint = {
                // The target point to zoom to for the current animation frame.  It must stay the same as the untranslated point
                x: (oldBase.x - targetModel.pan.x) * this.animationParams.progress,
                y: (oldBase.y - targetModel.pan.y) * this.animationParams.progress
            };
            return {
                x: -targetPoint.x,
                y: -targetPoint.y
            };
        };
        // now set the parameters of our new animation
        duration = duration ? duration * 1000 : this.config.zoomStepDuration * 1000;
        this.animationParams = {
            deltaZoomLevel: deltaZoomLevel,
            panStepFunc: panStepFunc,
            duration,
            progress: 0.0
        };
        this.startAnimation();
    }
    changeZoomLevel(newZoomLevel, clickPoint) {
        // console.log('PanZoomComponent: changeZoomLevel()');
        if (this.animationParams) {
            // let's let any current animation just finish
            return;
        }
        this.zoomLevelIsChanging = true;
        // keep zoom level in bounds
        newZoomLevel = Math.max(this.minimumAllowedZoomLevel, newZoomLevel);
        newZoomLevel = Math.min(this.config.zoomLevels - 1, newZoomLevel);
        // console.log('newZoomLevel:', newZoomLevel);
        const deltaZoomLevel = newZoomLevel - this.base.zoomLevel; // deltaZoomLevel is the number of zoom levels we are changing here
        if (!deltaZoomLevel) {
            // a deltaZoomLevel of zero means that we aren't changing zoom, because we're either zoomed all the way in or all the way out
            return;
        }
        //
        // Let p be the vector to the clicked point in view coords and let p' be the same point in model coords. Let s be a scale factor
        // and let t be a translation vector. Let the transformation be defined as:
        //
        //  p' = p * s + t
        //
        // And conversely:
        //
        //  p = (1/s)(p' - t)
        //
        // Now use subscription 0 to denote the value before transform and zoom and let 1 denote the value after transform. Scale
        // changes from s0 to s1. Translation changes from t0 to t1. But keep p and p' fixed so that the view coordinate p' still
        // corresponds to the model coordinate p. This can be expressed as an equation relying upon solely upon p', s0, s1, t0, and t1:
        //
        //  (1/s0)(p - t0) = (1/s1)(p - t1)
        //
        // Every variable but t1 is known, thus it is easily isolated to:
        //
        //  t1 = p' - (s1/s0)*(p' - t0)
        //
        const currentPan = {
            // t0 - the current base coordinates
            x: this.base.pan.x,
            y: this.base.pan.y
        };
        const currentScale = this.scale; // s0 - get the current CSS scale (scale0)
        const destPoint = clickPoint || this.getCentrePoint(); // pmark - the point we are aiming to zoom to (either the click point or the centre of the page)
        const panStepFunc = (zoomLevel) => {
            // this function gets called during every animation tick, to calculate where to move the model pan coordinates to (i.e. the translation) for that tick, where zoomLevel is calculated from the current zoomLevel + the target zoomLevel * the progress of the current animation
            const targetScale = this.getCssScale(zoomLevel); // s1 - the scale to translate to for the current animation tick
            const targetPoint = {
                // t1 - The target point to pan to.  It must stay the same as the untranslated point
                x: destPoint.x - (targetScale / currentScale) * (destPoint.x - currentPan.x),
                y: destPoint.y - (targetScale / currentScale) * (destPoint.y - currentPan.y)
            };
            return {
                // now return the difference between our initial click point and our translated (zoomed) click point
                // these are not absolute coordinates - just how far to move them
                x: targetPoint.x - currentPan.x,
                y: targetPoint.y - currentPan.y
            };
        };
        // now set the parameters of our new animation
        this.animationParams = {
            deltaZoomLevel: deltaZoomLevel,
            panStepFunc: panStepFunc,
            duration: this.config.zoomStepDuration * 1000,
            progress: 0.0
        };
        this.startAnimation();
    }
}
PanZoomComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: PanZoomComponent, deps: [{ token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component });
PanZoomComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.0.0", type: PanZoomComponent, selector: "pan-zoom", inputs: { config: "config" }, viewQueries: [{ propertyName: "frameElementRef", first: true, predicate: ["frameElement"], descendants: true, static: true }, { propertyName: "panElementRef", first: true, predicate: ["panElement"], descendants: true, static: true }, { propertyName: "zoomElementRef", first: true, predicate: ["zoomElement"], descendants: true, static: true }, { propertyName: "panzoomOverlayRef", first: true, predicate: ["panzoomOverlay"], descendants: true, static: true }], ngImport: i0, template: "<div\n  #frameElement\n  class=\"pan-zoom-frame\">\n\n    <div\n      #panElement\n      class=\"pan-element\">\n\n        <div\n          #zoomElement\n          class=\"zoom-element\">\n\n            <ng-content></ng-content>\n\n        </div>\n\n    </div>\n\n</div>\n\n<div\n  #panzoomOverlay\n  class=\"pan-zoom-overlay\">\n</div>", styles: [".pan-zoom-frame{position:relative;width:100%;height:100%;overflow:hidden}.pan-element{position:absolute;left:0px;top:0px}.pan-zoom-overlay{position:absolute;display:none;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none}\n"] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: PanZoomComponent, decorators: [{
            type: Component,
            args: [{ selector: 'pan-zoom', template: "<div\n  #frameElement\n  class=\"pan-zoom-frame\">\n\n    <div\n      #panElement\n      class=\"pan-element\">\n\n        <div\n          #zoomElement\n          class=\"zoom-element\">\n\n            <ng-content></ng-content>\n\n        </div>\n\n    </div>\n\n</div>\n\n<div\n  #panzoomOverlay\n  class=\"pan-zoom-overlay\">\n</div>", styles: [".pan-zoom-frame{position:relative;width:100%;height:100%;overflow:hidden}.pan-element{position:absolute;left:0px;top:0px}.pan-zoom-overlay{position:absolute;display:none;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.NgZone }]; }, propDecorators: { frameElementRef: [{
                type: ViewChild,
                args: ['frameElement', { static: true }]
            }], panElementRef: [{
                type: ViewChild,
                args: ['panElement', { static: true }]
            }], zoomElementRef: [{
                type: ViewChild,
                args: ['zoomElement', { static: true }]
            }], panzoomOverlayRef: [{
                type: ViewChild,
                args: ['panzoomOverlay', { static: true }]
            }], config: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFuem9vbS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtcGFuem9vbS9zcmMvbGliL3Bhbnpvb20uY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXBhbnpvb20vc3JjL2xpYi9wYW56b29tLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWdELFNBQVMsRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7O0FBc0NsSCxNQUFNLE9BQU8sZ0JBQWdCO0lBRTNCLFlBQXNCLElBQVk7UUFBWixTQUFJLEdBQUosSUFBSSxDQUFRO1FBa0IxQixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBSW5CLGFBQVEsR0FBRyxDQUFDLENBQUM7UUFDYixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ2pCLHdCQUFtQixHQUFHLElBQUksQ0FBQyxDQUFDLDZCQUE2QjtRQUV6RCxhQUFRLEdBQUcsS0FBSyxDQUFDO1FBRWpCLGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBRW5CLHdCQUFtQixHQUFHLEtBQUssQ0FBQztRQUM1QixrQkFBYSxHQUFHLEtBQUssQ0FBQztRQXdMOUIsZ0ZBQWdGO1FBU2hGLGdGQUFnRjtRQUNoRixnRkFBZ0Y7UUFDaEYsZ0ZBQWdGO1FBSXhFLGlCQUFZLEdBQUcsQ0FBQyxLQUFpQixFQUFFLEVBQUU7WUFDM0MsaUVBQWlFO1lBRWpFLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDMUMsT0FBTzthQUNSO1lBRUQsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztZQUUxQixJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUU7Z0JBRWhDLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtvQkFDeEIsT0FB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Y0FBYztZQUM5QixXQUFXLEVBQUUsV0FBVztZQUN4QixRQUFRLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJO1lBQzdDLFFBQVEsRUFBRSxHQUFHO1NBQ2QsQ0FBQztRQUNGLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUV4QixDQUFDOzs2R0F0OENVLGdCQUFnQjtpR0FBaEIsZ0JBQWdCLDJoQkN0QzdCLGlWQXVCTTsyRkRlTyxnQkFBZ0I7a0JBWDVCLFNBQVM7K0JBQ0UsVUFBVTs2RkFjaUMsZUFBZTtzQkFBbkUsU0FBUzt1QkFBQyxjQUFjLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUNRLGFBQWE7c0JBQS9ELFNBQVM7dUJBQUMsWUFBWSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFDVyxjQUFjO3NCQUFqRSxTQUFTO3VCQUFDLGFBQWEsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0JBQ2EsaUJBQWlCO3NCQUF2RSxTQUFTO3VCQUFDLGdCQUFnQixFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFFcEMsTUFBTTtzQkFBZCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgRWxlbWVudFJlZiwgVmlld0NoaWxkLCBJbnB1dCwgTmdab25lIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBQYW5ab29tQ29uZmlnIH0gZnJvbSAnLi9wYW56b29tLWNvbmZpZyc7XG5pbXBvcnQgeyBQYW5ab29tTW9kZWwgfSBmcm9tICcuL3Bhbnpvb20tbW9kZWwnO1xuaW1wb3J0IHsgUGFuWm9vbUFQSSwgWm9vbVR5cGUgfSBmcm9tICcuL3Bhbnpvb20tYXBpJztcbmltcG9ydCB7IFBvaW50IH0gZnJvbSAnLi90eXBlcy9wb2ludCc7XG5pbXBvcnQgeyBSZWN0IH0gZnJvbSAnLi90eXBlcy9yZWN0JztcbmltcG9ydCB7IE9mZnNldCB9IGZyb20gJy4vdHlwZXMvb2Zmc2V0JztcblxuXG5cbmludGVyZmFjZSBab29tQW5pbWF0aW9uIHtcbiAgZGVsdGFab29tTGV2ZWw6IG51bWJlcjtcbiAgcGFuU3RlcEZ1bmM6IEZ1bmN0aW9uO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBwcm9ncmVzczogbnVtYmVyO1xufVxuXG5cblxuaW50ZXJmYWNlIFBvc2l0aW9uIHtcbiAgeD86IG51bWJlcjtcbiAgeT86IG51bWJlcjtcbiAgbGVuZ3RoPzogbnVtYmVyO1xufVxuXG5cblxuQENvbXBvbmVudCgge1xuICBzZWxlY3RvcjogJ3Bhbi16b29tJyxcbiAgLy8gd2UgZG9uJ3Qgd2FudCB0byBraWxsIGNoYW5nZSBkZXRlY3Rpb24gZm9yIGFsbCBlbGVtZW50cyBiZW5lYXRoIHRoaXMsIHNvIHdlIGRvbid0IHNldCBPblB1c2guICBDaGlsZCB2aWV3cyBjYW4gaW1wbGVtZW50IE9uUHVzaCBpZiB0aGUgZGV2ZWxvcGVyIHdhbnRzIHRvLiAgV2UgY2FuIGdldCBhd2F5IHdpdGggdGhpcyBiZWNhdXNlIHRoZSAnd2hlZWwnIGV2ZW50IGhhbmRsZXIgcnVucyBvdXRzaWRlIG9mIEFuZ3VsYXIsIHRoZXJlZm9yZSBpdCBkb2VzbnQgdHJpZ2dlciBjaGFuZ2UgZGV0ZWN0aW9uLlxuICB0ZW1wbGF0ZVVybDogJy4vcGFuem9vbS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogW1xuICAgICcuL3Bhbnpvb20uY29tcG9uZW50LmNzcydcbiAgXVxufSApXG5cblxuXG5leHBvcnQgY2xhc3MgUGFuWm9vbUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICBjb25zdHJ1Y3RvciAoIHByaXZhdGUgem9uZTogTmdab25lICkge31cblxuICBAVmlld0NoaWxkKCdmcmFtZUVsZW1lbnQnLCB7IHN0YXRpYzogdHJ1ZSB9KSBwcml2YXRlIGZyYW1lRWxlbWVudFJlZjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgncGFuRWxlbWVudCcsIHsgc3RhdGljOiB0cnVlIH0pIHByaXZhdGUgcGFuRWxlbWVudFJlZjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnem9vbUVsZW1lbnQnLCB7IHN0YXRpYzogdHJ1ZSB9KSBwcml2YXRlIHpvb21FbGVtZW50UmVmOiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKCdwYW56b29tT3ZlcmxheScsIHsgc3RhdGljOiB0cnVlIH0pIHByaXZhdGUgcGFuem9vbU92ZXJsYXlSZWY6IEVsZW1lbnRSZWY7XG5cbiAgQElucHV0KCkgY29uZmlnOiBQYW5ab29tQ29uZmlnO1xuXG4gIHByaXZhdGUgYmFzZTogUGFuWm9vbU1vZGVsOyAvLyB0aGlzIGlzIHdoYXQgdGhlIHBhbi96b29tIHZpZXcgaXMgYmVmb3JlIGEgem9vbSBhbmltYXRpb24gYmVnaW5zIGFuZCBhZnRlciBpdCBlbmRzLiAgSXQgYWxzbyB1cGRhdGVzIHdpdGggZXZlcnkgbW91c2UgZHJhZyBvciBmcmVlWm9vbSwgYnV0IHRoZSBhbmltYXRpb24gaXMgbW9zdGx5IHRpZWQgdG8gdGhlIG1vZGVsLlxuICBwcml2YXRlIG1vZGVsOiBQYW5ab29tTW9kZWw7IC8vIHRoaXMgaXMgdXNlZCBmb3IgaW5jcmVtZW50YWwgY2hhbmdlcyB0byB0aGUgcGFuL3pvb20gdmlldyBkdXJpbmcgZWFjaCBhbmltYXRpb24gZnJhbWUuICBTZXR0aW5nIGl0IHdpbGwgdXBkYXRlIHRoZSBwYW4vem9vbSBjb29yZGluYXRlcyBvbiB0aGUgbmV4dCBjYWxsIHRvIHVwZGF0ZURPTSgpLiAgTm90IHVzZWQgZHVyaW5nIG1vdXNlIGRyYWcuXG4gIHByaXZhdGUgYXBpOiBQYW5ab29tQVBJO1xuICBwcml2YXRlIGNvbnRlbnRIZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBjb250ZW50V2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBmcmFtZUhlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIGZyYW1lV2lkdGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBsYXN0TW91c2VFdmVudFRpbWU6IG51bWJlcjtcbiAgcHJpdmF0ZSBwcmV2aW91c1Bvc2l0aW9uOiBQb3NpdGlvbjtcbiAgcHJpdmF0ZSBpc0RyYWdnaW5nID0gZmFsc2U7XG4gIHByaXZhdGUgcGFuVmVsb2NpdHk6IFBvaW50O1xuICBwcml2YXRlIGFuaW1hdGlvblBhcmFtczogWm9vbUFuaW1hdGlvbjtcbiAgcHJpdmF0ZSBhbmltYXRpb25GcmFtZUZ1bmM6IEZ1bmN0aW9uOyAvLyByZWZlcmVuY2UgdG8gdGhlIGFwcHJvcHJpYXRlIGdldEFuaW1hdGlvbkZyYW1lIGZ1bmN0aW9uIGZvciB0aGUgY2xpZW50IGJyb3dzZXJcbiAgcHJpdmF0ZSBsYXN0VGljayA9IDA7XG4gIHByaXZhdGUgaXNDaHJvbWUgPSBmYWxzZTtcbiAgcHJpdmF0ZSB3aWxsQ2hhbmdlTmV4dEZyYW1lID0gdHJ1ZTsgLy8gdXNlZCBmb3Igc2NhbGluZyBpbiBDaHJvbWVcbiAgcHJpdmF0ZSBhbmltYXRpb25JZDogbnVtYmVyO1xuICBwcml2YXRlIGlzTW9iaWxlID0gZmFsc2U7XG4gIHByaXZhdGUgc2NhbGU6IG51bWJlcjtcbiAgcHJpdmF0ZSBpc0ZpcnN0U3luYyA9IHRydWU7XG4gIHByaXZhdGUgbGFzdENsaWNrUG9pbnQ6IFBvaW50O1xuICBwcml2YXRlIHpvb21MZXZlbElzQ2hhbmdpbmcgPSBmYWxzZTtcbiAgcHJpdmF0ZSBkcmFnRmluaXNoaW5nID0gZmFsc2U7XG4gIHByaXZhdGUgZHJhZ01vdXNlQnV0dG9uOiBudW1iZXI7XG5cbiAgcHJpdmF0ZSBtYXhTY2FsZTogbnVtYmVyOyAvLyB0aGUgaGlnaGVzdCBzY2FsZSAoZnVydGhlc3Qgem9vbWVkIGluKSB0aGF0IHdlIHdpbGwgYWxsb3cgaW4gZnJlZSB6b29tIG1vZGUgKGNhbGN1bGF0ZWQpXG4gIHByaXZhdGUgbWluU2NhbGU6IG51bWJlcjsgLy8gdGhlIHNtYWxsZXN0IHNjYWxlIChmdXJ0aGVzdCB6b29tZWQgb3V0KSB0aGF0IHdlIHdpbGwgYWxsb3cgaW4gZnJlZSB6b29tIG1vZGUgKGNhbGN1bGF0ZWQpXG4gIHByaXZhdGUgbWluaW11bUFsbG93ZWRab29tTGV2ZWw6IG51bWJlcjtcblxuICBwcml2YXRlIHJlc2l6ZU9ic2VydmVyOiBhbnk7IC8vIHdhaXRpbmcgZm9yIGEgVHlwZXNjcmlwdCBkZWZpbml0aW9uIGZvciBSZXNpemVPYnNlcnZlclxuXG5cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogbmdPbkluaXQoKTogaW5pdGlhbGl6aW5nIFBhblpvb21Db21wb25lbnQnKTtcblxuICAgIGlmICh0aGlzLmNvbmZpZy5pbml0aWFsWm9vbVRvRml0KSB7XG4gICAgICB0aGlzLmJhc2UgPSB0aGlzLmNhbGNab29tVG9GaXQodGhpcy5jb25maWcuaW5pdGlhbFpvb21Ub0ZpdCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5iYXNlID0ge1xuICAgICAgICB6b29tTGV2ZWw6IHRoaXMuY29uZmlnLmluaXRpYWxab29tTGV2ZWwsXG4gICAgICAgIHBhbjoge1xuICAgICAgICAgIHg6IHRoaXMuY29uZmlnLmluaXRpYWxQYW5YLFxuICAgICAgICAgIHk6IHRoaXMuY29uZmlnLmluaXRpYWxQYW5ZXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGhpcy5tb2RlbCA9IHtcbiAgICAgIHpvb21MZXZlbDogdGhpcy5iYXNlLnpvb21MZXZlbCxcbiAgICAgIGlzUGFubmluZzogZmFsc2UsIC8vIE9ubHkgdHJ1ZSBpZiBwYW5uaW5nIGlzIGFjdHVhbGx5IHRha2luZyBwbGFjZSwgbm90IGp1c3QgYWZ0ZXIgbW91c2Vkb3duXG4gICAgICBwYW46IHtcbiAgICAgICAgeDogdGhpcy5iYXNlLnBhbi54LFxuICAgICAgICB5OiB0aGlzLmJhc2UucGFuLnlcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5jb25maWcubW9kZWxDaGFuZ2VkLm5leHQodGhpcy5tb2RlbCk7XG5cbiAgICAvLyBjcmVhdGUgcHVibGljIEFQSVxuICAgIHRoaXMuYXBpID0ge1xuICAgICAgbW9kZWw6IHRoaXMubW9kZWwsXG4gICAgICBjb25maWc6IHRoaXMuY29uZmlnLFxuICAgICAgY2hhbmdlWm9vbUxldmVsOiB0aGlzLnpvb21Ub0xldmVsQW5kUG9pbnQuYmluZCh0aGlzKSxcbiAgICAgIHpvb21JbjogdGhpcy56b29tSW4uYmluZCh0aGlzKSxcbiAgICAgIHpvb21PdXQ6IHRoaXMuem9vbU91dC5iaW5kKHRoaXMpLFxuICAgICAgem9vbVRvRml0OiB0aGlzLnpvb21Ub0ZpdC5iaW5kKHRoaXMpLFxuICAgICAgcmVzZXRWaWV3OiB0aGlzLnJlc2V0Vmlldy5iaW5kKHRoaXMpLFxuICAgICAgZ2V0Vmlld1Bvc2l0aW9uOiB0aGlzLmdldFZpZXdQb3NpdGlvbi5iaW5kKHRoaXMpLFxuICAgICAgZ2V0TW9kZWxQb3NpdGlvbjogdGhpcy5nZXRNb2RlbFBvc2l0aW9uLmJpbmQodGhpcyksXG4gICAgICBwYW5Ub1BvaW50OiB0aGlzLnBhblRvUG9pbnQuYmluZCh0aGlzKSxcbiAgICAgIHBhbkRlbHRhOiB0aGlzLnBhbkRlbHRhLmJpbmQodGhpcyksXG4gICAgICBwYW5EZWx0YVBlcmNlbnQ6IHRoaXMucGFuRGVsdGFQZXJjZW50LmJpbmQodGhpcyksXG4gICAgICBwYW5EZWx0YUFic29sdXRlOiB0aGlzLnBhbkRlbHRhQWJzb2x1dGUuYmluZCh0aGlzKSxcbiAgICAgIGNlbnRlckNvbnRlbnQ6IHRoaXMuY2VudGVyQ29udGVudC5iaW5kKHRoaXMpLFxuICAgICAgY2VudGVyWDogdGhpcy5jZW50ZXJYLmJpbmQodGhpcyksXG4gICAgICBjZW50ZXJZOiB0aGlzLmNlbnRlclkuYmluZCh0aGlzKSxcbiAgICAgIGNlbnRlclRvcExlZnQ6IHRoaXMuY2VudGVyVG9wTGVmdENvcm5lci5iaW5kKHRoaXMpLFxuICAgICAgY2VudGVyQm90dG9tTGVmdDogdGhpcy5jZW50ZXJCb3R0b21MZWZ0Q29ybmVyLmJpbmQodGhpcyksXG4gICAgICBjZW50ZXJUb3BSaWdodDogdGhpcy5jZW50ZXJUb3BSaWdodENvcm5lci5iaW5kKHRoaXMpLFxuICAgICAgY2VudGVyQm90dG9tUmlnaHQ6IHRoaXMuY2VudGVyQm90dG9tUmlnaHRDb3JuZXIuYmluZCh0aGlzKSxcbiAgICAgIHVwZGF0ZUNvbnRlbnREaW1lbnNpb25zOiB0aGlzLnVwZGF0ZUNvbnRlbnREaW1lbnNpb25zLmJpbmQodGhpcyksXG4gICAgICBkZXRlY3RDb250ZW50RGltZW5zaW9uczogdGhpcy5kZXRlY3RDb250ZW50RGltZW5zaW9ucy5iaW5kKHRoaXMpXG4gICAgfTtcblxuICAgIHRoaXMuY29uZmlnLmFwaS5uZXh0KHRoaXMuYXBpKTtcblxuICAgIGlmICh0aGlzLmNvbmZpZy5mcmVlTW91c2VXaGVlbCkge1xuICAgICAgdGhpcy5zY2FsZSA9IHRoaXMuZ2V0Q3NzU2NhbGUodGhpcy5jb25maWcuaW5pdGlhbFpvb21MZXZlbCk7XG4gICAgICBjb25zdCBtYXhab29tTGV2ZWwgPSB0aGlzLmNvbmZpZy56b29tTGV2ZWxzIC0gMTtcbiAgICAgIHRoaXMubWF4U2NhbGUgPSB0aGlzLmdldENzc1NjYWxlKG1heFpvb21MZXZlbCk7XG4gICAgICB0aGlzLm1pblNjYWxlID0gdGhpcy5nZXRDc3NTY2FsZSgwKTtcbiAgICB9XG5cbiAgICB0aGlzLm1pbmltdW1BbGxvd2VkWm9vbUxldmVsID0gMDtcbiAgICBpZiAodGhpcy5jb25maWcua2VlcEluQm91bmRzKSB7XG4gICAgICB0aGlzLm1pbmltdW1BbGxvd2VkWm9vbUxldmVsID0gdGhpcy5jb25maWcubmV1dHJhbFpvb21MZXZlbDtcbiAgICAgIHRoaXMubWluU2NhbGUgPSB0aGlzLmdldENzc1NjYWxlKHRoaXMuY29uZmlnLm5ldXRyYWxab29tTGV2ZWwpO1xuICAgIH1cblxuICAgIHRoaXMuem9vbUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWxsQ2hhbmdlID0gJ3RyYW5zZm9ybSc7XG4gICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKCdDaHJvbWUnKSA+PSAwKSB7XG4gICAgICB0aGlzLmlzQ2hyb21lID0gdHJ1ZTtcbiAgICAgIHRoaXMuem9vbUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWigwKSc7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29uZmlnLmFjY2VsZXJhdGVQYW4pIHtcbiAgICAgIHRoaXMucGFuRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnN0eWxlLndpbGxDaGFuZ2UgPSAndHJhbnNmb3JtJztcbiAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaCgnQ2hyb21lJykgPj0gMCkge1xuICAgICAgICB0aGlzLmlzQ2hyb21lID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wYW5FbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVooMCknO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYW5pbWF0aW9uVGljaygpO1xuICAgIHRoaXMuc2NhbGUgPSB0aGlzLmdldENzc1NjYWxlKHRoaXMuYmFzZS56b29tTGV2ZWwpO1xuICAgIHRoaXMuaXNGaXJzdFN5bmMgPSBmYWxzZTtcbiAgICBzd2l0Y2ggKHRoaXMuY29uZmlnLmRyYWdNb3VzZUJ1dHRvbikge1xuICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgIHRoaXMuZHJhZ01vdXNlQnV0dG9uID0gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdtaWRkbGUnOlxuICAgICAgICB0aGlzLmRyYWdNb3VzZUJ1dHRvbiA9IDE7XG4gICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdhdXhjbGljaycsIHRoaXMucHJldmVudERlZmF1bHQgKSApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCAoKSA9PiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIHRoaXMucHJldmVudERlZmF1bHQgKSApO1xuICAgICAgICB0aGlzLmRyYWdNb3VzZUJ1dHRvbiA9IDI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhpcy5kcmFnTW91c2VCdXR0b24gPSAwOyAvLyBsZWZ0XG4gICAgfVxuXG5cbiAgfVxuXG5cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IG5nQWZ0ZXJWaWV3SW5pdCgpJyk7XG5cbiAgICB0aGlzLmRldGVjdENvbnRlbnREaW1lbnNpb25zKCk7XG5cbiAgICBjb25zdCBmcmFtZVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KTtcbiAgICB0aGlzLmZyYW1lSGVpZ2h0ID0gcGFyc2VJbnQoIGZyYW1lU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0Jykuc3BsaXQoJ3B4JylbMF0gKTtcbiAgICB0aGlzLmZyYW1lV2lkdGggPSBwYXJzZUludCggZnJhbWVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCd3aWR0aCcpLnNwbGl0KCdweCcpWzBdICk7XG5cbiAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IHRoaXMuYW5pbWF0aW9uRnJhbWVGdW5jID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSApO1xuXG4gICAgaWYgKHRoaXMuY29uZmlnLmR5bmFtaWNDb250ZW50RGltZW5zaW9ucykge1xuICAgICAgaWYgKCh3aW5kb3cgYXMgYW55KS5SZXNpemVPYnNlcnZlcikge1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbmV3ICh3aW5kb3cgYXMgYW55KS5SZXNpemVPYnNlcnZlciggZW50cmllcyA9PiB0aGlzLm9uQ29udGVudERpbWVuc2lvbnNDaGFuZ2VEZXRlY3RlZChlbnRyaWVzKSApO1xuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLnpvb21FbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpICk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUmVzaXplT2JzZXJ2ZXIgQVBJIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBicm93c2VyLiAgU2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9SZXNpemVPYnNlcnZlciBmb3IgaW5mbyBvbiBicm93c2VyIGNvbXBhdGliaWxpdHkuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNNb2JpbGVEZXZpY2UoKSnCoHtcbiAgICAgIHRoaXMuaXNNb2JpbGUgPSB0cnVlO1xuICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCAoKSA9PiB0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hTdGFydCApICk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCAoKSA9PiB7XG4gICAgICAgIHRoaXMuZnJhbWVFbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlZG93bik7XG4gICAgICAgIHRoaXMuZnJhbWVFbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCB0aGlzLm9uRGJsQ2xpY2sgKTtcbiAgICAgICAgdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudCkgPT4gdGhpcy5hbmltYXRpb25GcmFtZUZ1bmMoICgpID0+IHRoaXMub25Nb3VzZVdoZWVsKGV2ZW50KSApLCB7IHBhc3NpdmU6IHRydWUgfSApO1xuICAgICAgfSApO1xuICAgIH1cblxuICB9XG5cblxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBuZ09uRGVzdHJveSgpJyk7XG4gICAgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgIHRoaXMuZnJhbWVFbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Ub3VjaFN0YXJ0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25Nb3VzZWRvd24pO1xuICAgICAgdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudCkgPT4gdGhpcy5hbmltYXRpb25GcmFtZUZ1bmMoICgpID0+IHRoaXMub25Nb3VzZVdoZWVsKGV2ZW50KSApLCB7IHBhc3NpdmU6IHRydWUgfSApO1xuICAgICAgdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIHRoaXMub25EYmxDbGljayk7XG4gICAgfVxuICAgIGlmICh0aGlzLmFuaW1hdGlvbkZyYW1lRnVuYyAmJiB0aGlzLmFuaW1hdGlvbklkKSB7XG4gICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5hbmltYXRpb25JZCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyKSB7XG4gICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICB9XG4gICAgc3dpdGNoICh0aGlzLmNvbmZpZy5kcmFnTW91c2VCdXR0b24pIHtcbiAgICAgIGNhc2UgJ21pZGRsZSc6XG4gICAgICAgIHRoaXMuZHJhZ01vdXNlQnV0dG9uID0gMTtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCAoKSA9PiB0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2F1eGNsaWNrJywgdGhpcy5wcmV2ZW50RGVmYXVsdCApICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgdGhpcy5wcmV2ZW50RGVmYXVsdCApICk7XG4gICAgICAgIHRoaXMuZHJhZ01vdXNlQnV0dG9uID0gMjtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cblxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIE9GIExJRkVDWUNMRSBIT09LUyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuXG5cblxuXG5cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRVZFTlQgSEFORExFUlMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cblxuICBwcml2YXRlIG9uTW91c2VXaGVlbCA9IChldmVudDogV2hlZWxFdmVudCkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBPbk1vdXNlV2hlZWwoKSBldmVudDonLCBldmVudCk7XG5cbiAgICBpZiAoIShldmVudCAmJiBldmVudC5wYWdlWCAmJiBldmVudC5wYWdlWSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgZGVsdGFZID0gZXZlbnQuZGVsdGFZO1xuXG4gICAgaWYgKHRoaXMuY29uZmlnLnpvb21Pbk1vdXNlV2hlZWwpIHtcblxuICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICAgIHJldHVybjsgLy8gYWxyZWFkeSB6b29taW5nXG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5jb25maWcuaW52ZXJ0TW91c2VXaGVlbCkge1xuICAgICAgICBkZWx0YVkgPSAtZGVsdGFZO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmcmFtZUVsZW1lbnRPZmZzZXQgPSB0aGlzLmdldEZyYW1lRWxlbWVudE9mZnNldCgpO1xuICAgICAgY29uc3QgY2xpY2tQb2ludDogUG9pbnQgPSB7XG4gICAgICAgIHg6IGV2ZW50LnBhZ2VYIC0gZnJhbWVFbGVtZW50T2Zmc2V0LmxlZnQsXG4gICAgICAgIHk6IGV2ZW50LnBhZ2VZIC0gZnJhbWVFbGVtZW50T2Zmc2V0LnRvcFxuICAgICAgfTtcblxuICAgICAgdGhpcy5sYXN0Q2xpY2tQb2ludCA9IGNsaWNrUG9pbnQ7XG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5mcmVlTW91c2VXaGVlbCkge1xuICAgICAgICAvLyBmcmVlIHdoZWVsIHNjcm9sbFxuICAgICAgICB0aGlzLmZyZWVab29tKGNsaWNrUG9pbnQsIGRlbHRhWSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKGRlbHRhWSA8IDApIHtcbiAgICAgICAgICB0aGlzLnpvb21JblRvUG9pbnQoY2xpY2tQb2ludCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVsdGFZID4gMCkge1xuICAgICAgICAgIHRoaXMuem9vbU91dEZyb21Qb2ludChjbGlja1BvaW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cblxuICAvKipcbiAgICogTWV0aG9kIHdpbGwgY2hlY2sgaWYgJ2NoaWxkJyBub2RlIGVsZW1lbnQgaXMgYSBjaGlsZCBvZlxuICAgKiBwYXJlbnQgbm9kZSB3aXRoIGNsYXNzICdjbGFzc05hbWUnXG4gICAqIEBwYXJhbSBjbGFzc05hbWVcbiAgICogQHBhcmFtIGNoaWxkXG4gICAqL1xuICBwcml2YXRlIGlzUGFyZW50RWxlbWVudChjbGFzc05hbWUsIGNoaWxkKSB7XG4gICAgbGV0IG5vZGUgPSBjaGlsZC5wYXJlbnROb2RlO1xuICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgICBpZiAobm9kZS5jbGFzc0xpc3QgJiYgbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG5cblxuICBwcml2YXRlIG9uTW91c2Vkb3duID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogb25Nb3VzZWRvd24oKScsIGV2ZW50KTtcblxuICAgIC8qIENoZWNrIGlmIGNsaWNrZWQgbG9jYXRpb24gaXMgaW5zaWRlIGVsZW1lbnQgZnJvbSB3aGljaFxuICAgICAgIGRyYWdnaW5nIGlzIHByZXZlbnRlZC4gKi9cbiAgICBpZiAodGhpcy5jb25maWcubm9EcmFnRnJvbUVsZW1lbnRDbGFzc1xuICAgICAgICAmJiB0aGlzLmlzUGFyZW50RWxlbWVudCh0aGlzLmNvbmZpZy5ub0RyYWdGcm9tRWxlbWVudENsYXNzLCBldmVudC5zcmNFbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChldmVudC5idXR0b24gPT09IHRoaXMuZHJhZ01vdXNlQnV0dG9uIHx8IGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0Jykge1xuXG4gICAgICBpZiAoZXZlbnQudHlwZSAhPT0gJ3RvdWNoc3RhcnQnKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZHJhZ0ZpbmlzaGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5wYW5WZWxvY2l0eSA9IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHRoaXMuY29uZmlnLnBhbk9uQ2xpY2tEcmFnKSB7XG4gICAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IHtcbiAgICAgICAgICB4OiBldmVudC5wYWdlWCxcbiAgICAgICAgICB5OiBldmVudC5wYWdlWVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxhc3RNb3VzZUV2ZW50VGltZSA9IGV2ZW50LnRpbWVTdGFtcDtcbiAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tb2RlbC5pc1Bhbm5pbmcgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5pc01vYmlsZSkge1xuICAgICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uVG91Y2hFbmQsIGZhbHNlICkgKTsgLy8gbGVhdmUgdGhpcyBvbiBkb2N1bWVudFxuICAgICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vblRvdWNoTW92ZSwgeyBwYXNzaXZlOiB0cnVlLCBjYXB0dXJlOiBmYWxzZSB9ICkgKTsgLy8gbGVhdmUgdGhpcyBvbiBkb2N1bWVudFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZSwgeyBwYXNzaXZlOiB0cnVlLCBjYXB0dXJlOiBmYWxzZSB9ICkgKTsgLy8gbGVhdmUgdGhpcyBvbiBkb2N1bWVudFxuICAgICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMub25Nb3VzZVVwICkgKTsgLy8gbGVhdmUgdGhpcyBvbiBkb2N1bWVudFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBvblRvdWNoU3RhcnQgPSAoZXZlbnQ6IFRvdWNoRXZlbnQpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogb25Ub3VjaFN0YXJ0KCknLCBldmVudCk7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IG9uVG91Y2hTdGFydCgpOiB0b3VjaGVzOicsIGV2ZW50LnRvdWNoZXMubGVuZ3RoKTtcblxuICAgIC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgLy8gbXVsdGlwbGUgdG91Y2hlcywgZ2V0IHJlYWR5IGZvciB6b29taW5nXG5cbiAgICAgIC8vIENhbGN1bGF0ZSB4IGFuZCB5IGRpc3RhbmNlIGJldHdlZW4gdG91Y2ggZXZlbnRzXG4gICAgICBjb25zdCB4ID0gZXZlbnQudG91Y2hlc1swXS5wYWdlWCAtIGV2ZW50LnRvdWNoZXNbMV0ucGFnZVg7XG4gICAgICBjb25zdCB5ID0gZXZlbnQudG91Y2hlc1swXS5wYWdlWSAtIGV2ZW50LnRvdWNoZXNbMV0ucGFnZVk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBsZW5ndGggYmV0d2VlbiB0b3VjaCBwb2ludHMgd2l0aCBweXRoYWdvcmFzXG4gICAgICAvLyBUaGVyZSBpcyBubyByZWFzb24gdG8gdXNlIE1hdGgucG93IGFuZCBNYXRoLnNxcnQgYXMgd2VcbiAgICAgIC8vIG9ubHkgd2FudCBhIHJlbGF0aXZlIGxlbmd0aCBhbmQgbm90IHRoZSBleGFjdCBvbmUuXG4gICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24gPSB7XG4gICAgICAgIGxlbmd0aDogeCAqIHggKyB5ICogeVxuICAgICAgfTtcbiAgICB9XG4gICAgdGhpcy5vbk1vdXNlZG93bihldmVudCk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBvbk1vdXNlTW92ZSA9IChldmVudDogYW55KSA9PiB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IG9uTW91c2VNb3ZlKCknLCBldmVudCk7XG4gICAgLy8gY29uc29sZS5sb2coYFBhblpvb21Db21wb25lbnQ6IG9uTW91c2VNb3ZlKCk6IGV2ZW50LnRpbWVTdGFtcDpgLCBldmVudC50aW1lU3RhbXApO1xuICAgIC8vIHRpbWVzdGFtcCAtIDEwNTg3Ljg3OTk5OTk5OTEzMiAtIG1pbGxpc2Vjb25kc1xuICAgIC8vIENhbGxlZCB3aGVuIG1vdmluZyB0aGUgbW91c2Ugd2l0aCB0aGUgbGVmdCBidXR0b24gZG93blxuXG4gICAgbGV0IGV2V3JhcDtcbiAgICBpZiAoZXZlbnQgJiYgZXZlbnQucGFnZVggJiYgZXZlbnQucGFnZVkpIHtcbiAgICAgIGV2V3JhcCA9IGV2ZW50O1xuICAgIH1cbiAgICBlbHNlIGlmICgoZXZlbnQudHlwZSA9PT0gJ3RvdWNobW92ZScpICYmIGV2ZW50LnRvdWNoZXNbMF0ucGFnZVggJiYgZXZlbnQudG91Y2hlc1swXS5wYWdlWSkge1xuICAgICAgZXZXcmFwID0geyBcbiAgICAgICAgcGFnZVg6IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVgsXG4gICAgICAgIHBhZ2VZOiBldmVudC50b3VjaGVzWzBdLnBhZ2VZXG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG5vdyA9IGV2ZW50LnRpbWVTdGFtcDtcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0TW91c2VFdmVudCA9IChub3cgLSB0aGlzLmxhc3RNb3VzZUV2ZW50VGltZSkgLyAxMDAwO1xuICAgIHRoaXMubGFzdE1vdXNlRXZlbnRUaW1lID0gbm93O1xuICAgIGNvbnN0IGRyYWdEZWx0YSA9IHtcbiAgICAgIC8vIGEgcmVwcmVzZW50YXRpb24gb2YgaG93IGZhciBlYWNoIGNvb3JkaW5hdGUgaGFzIG1vdmVkIHNpbmNlIHRoZSBsYXN0IHRpbWUgaXQgd2FzIG1vdmVkXG4gICAgICB4OiBldldyYXAucGFnZVggLSB0aGlzLnByZXZpb3VzUG9zaXRpb24ueCxcbiAgICAgIHk6IGV2V3JhcC5wYWdlWSAtIHRoaXMucHJldmlvdXNQb3NpdGlvbi55XG4gICAgfTtcblxuICAgIGlmICh0aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHMpIHtcbiAgICAgIGNvbnN0IHRvcExlZnRDb3JuZXJWaWV3ID0gdGhpcy5nZXRWaWV3UG9zaXRpb24oIHsgeDogMCwgeTogMCB9ICk7XG4gICAgICBjb25zdCBib3R0b21SaWdodENvcm5lclZpZXcgPSB0aGlzLmdldFZpZXdQb3NpdGlvbiggeyB4OiB0aGlzLmNvbnRlbnRXaWR0aCwgeTogdGhpcy5jb250ZW50SGVpZ2h0IH0gKTtcblxuXG4gICAgICBpZiAodG9wTGVmdENvcm5lclZpZXcueCA+IDAgJiYgZHJhZ0RlbHRhLnggPiAwKSB7XG4gICAgICAgIGRyYWdEZWx0YS54ICo9IE1hdGgubWluKDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucG93KHRvcExlZnRDb3JuZXJWaWV3LngsIC10aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHNEcmFnUHVsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRvcExlZnRDb3JuZXJWaWV3LnkgPiAwICYmIGRyYWdEZWx0YS55ID4gMCkge1xuICAgICAgICBkcmFnRGVsdGEueSAqPSBNYXRoLm1pbigxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucG93KHRvcExlZnRDb3JuZXJWaWV3LnksIC10aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHNEcmFnUHVsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChib3R0b21SaWdodENvcm5lclZpZXcueCA8IHRoaXMuY29udGVudFdpZHRoICYmIGRyYWdEZWx0YS54IDwgMCkge1xuICAgICAgICBkcmFnRGVsdGEueCAqPSBNYXRoLm1pbigxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucG93KHRoaXMuY29udGVudFdpZHRoIC0gYm90dG9tUmlnaHRDb3JuZXJWaWV3LngsIC10aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHNEcmFnUHVsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJvdHRvbVJpZ2h0Q29ybmVyVmlldy55IDwgdGhpcy5jb250ZW50SGVpZ2h0ICYmIGRyYWdEZWx0YS55IDwgMCkge1xuICAgICAgICBkcmFnRGVsdGEueSAqPSBNYXRoLm1pbigxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3codGhpcy5jb250ZW50SGVpZ2h0IC0gYm90dG9tUmlnaHRDb3JuZXJWaWV3LnksIC10aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHNEcmFnUHVsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBub3cgcGFuIHRoZSB2aWV3XG4gICAgY29uc3QgZGVsdGE6IFBvaW50ID0ge1xuICAgICAgeDogZHJhZ0RlbHRhLnggfHwgMCxcbiAgICAgIHk6IGRyYWdEZWx0YS55IHx8IDBcbiAgICB9O1xuICAgIHRoaXMubW9kZWwucGFuLnggKz0gZGVsdGEueDtcbiAgICB0aGlzLm1vZGVsLnBhbi55ICs9IGRlbHRhLnk7XG4gICAgdGhpcy5zeW5jQmFzZVRvTW9kZWwoKTtcbiAgICB0aGlzLmFuaW1hdGlvblRpY2soKTtcblxuICAgIGlmICghdGhpcy5tb2RlbC5pc1Bhbm5pbmcpIHtcbiAgICAgIC8vIFRoaXMgd2lsbCBpbXByb3ZlIHRoZSBwZXJmb3JtYW5jZSxcbiAgICAgIC8vIGJlY2F1c2UgdGhlIGJyb3dzZXIgc3RvcHMgZXZhbHVhdGluZyBoaXRzIGFnYWluc3QgdGhlIGVsZW1lbnRzIGRpc3BsYXllZCBpbnNpZGUgdGhlIHBhbiB6b29tIHZpZXcuXG4gICAgICAvLyBCZXNpZGVzIHRoaXMsIG1vdXNlIGV2ZW50cyB3aWxsIG5vdCBiZSBzZW50IHRvIGFueSBvdGhlciBlbGVtZW50cyxcbiAgICAgIC8vIHRoaXMgcHJldmVudHMgaXNzdWVzIGxpa2Ugc2VsZWN0aW5nIGVsZW1lbnRzIHdoaWxlIGRyYWdnaW5nLlxuICAgICAgdGhpcy5wYW56b29tT3ZlcmxheVJlZi5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cbiAgICB0aGlzLm1vZGVsLmlzUGFubmluZyA9IHRydWU7XG5cbiAgICAvLyBzZXQgdGhlc2UgZm9yIHRoZSBhbmltYXRpb24gc2xvdyBkb3duIG9uY2UgZHJhZyBzdG9wc1xuICAgIC8vIHBhblZlbG9jaXR5IGlzIGEgbWVhc3VyZW1lbnQgb2Ygc3BlZWQgZm9yIHggYW5kIHkgY29vcmRpbmF0ZXMsIGluIHBpeGVscyBwZXIgbW91c2UgbW92ZSBldmVudC4gIEl0IGlzIGEgbWVhc3VyZSBvZiBob3cgZmFzdCB0aGUgbW91c2UgaXMgbW92aW5nXG4gICAgY29uc3QgcGFuVmVsb2NpdHlYID0gZHJhZ0RlbHRhLnggLyB0aW1lU2luY2VMYXN0TW91c2VFdmVudDtcbiAgICBjb25zdCBwYW5WZWxvY2l0eVkgPSBkcmFnRGVsdGEueSAvIHRpbWVTaW5jZUxhc3RNb3VzZUV2ZW50O1xuICAgIHRoaXMucGFuVmVsb2NpdHkgPSB7XG4gICAgICB4OiAhTnVtYmVyLmlzRmluaXRlKHBhblZlbG9jaXR5WCkgPyAwIDogcGFuVmVsb2NpdHlYLFxuICAgICAgeTogIU51bWJlci5pc0Zpbml0ZShwYW5WZWxvY2l0eVkpID8gMCA6IHBhblZlbG9jaXR5WVxuICAgIH07XG4gICAgLy8gY29uc29sZS5sb2coYFBhblpvb21Db21wb25lbnQ6IG9uTW91c2VNb3ZlKCk6IHBhblZlbG9jaXR5OmAsIHRoaXMucGFuVmVsb2NpdHkpO1xuXG4gICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uID0ge1xuICAgICAgeDogZXZXcmFwLnBhZ2VYLFxuICAgICAgeTogZXZXcmFwLnBhZ2VZXG4gICAgfTtcblxuICB9XG5cblxuXG4gIHByaXZhdGUgb25Ub3VjaE1vdmUgPSAoZXZlbnQ6IGFueSkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBvblRvdWNoTW92ZSgpJyk7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IG9uVG91Y2hNb3ZlKCk6IGV2ZW50OicsIGV2ZW50KTtcblxuICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgLy8gc2luZ2xlIHRvdWNoLCBlbXVsYXRlIG1vdXNlIG1vdmVcbiAgICAgIHRoaXMub25Nb3VzZU1vdmUoZXZlbnQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIC8vIG11bHRpcGxlIHRvdWNoZXMsIHpvb20gaW4vb3V0XG4gICAgICAvLyBjb25zb2xlLmxvZygncGluY2ggem9vbWluZycpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgeCBhbmQgeSBkaXN0YW5jZSBiZXR3ZWVuIHRvdWNoIGV2ZW50c1xuICAgICAgY29uc3QgeCA9IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVggLSBldmVudC50b3VjaGVzWzFdLnBhZ2VYO1xuICAgICAgY29uc3QgeSA9IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVkgLSBldmVudC50b3VjaGVzWzFdLnBhZ2VZO1xuICAgICAgLy8gQ2FsY3VsYXRlIGxlbmd0aCBiZXR3ZWVuIHRvdWNoIHBvaW50cyB3aXRoIHB5dGhhZ29yYXNcbiAgICAgIC8vIFRoZXJlIGlzIG5vIHJlYXNvbiB0byB1c2UgTWF0aC5wb3cgYW5kIE1hdGguc3FydCBhcyB3ZVxuICAgICAgLy8gb25seSB3YW50IGEgcmVsYXRpdmUgbGVuZ3RoIGFuZCBub3QgdGhlIGV4YWN0IG9uZS5cbiAgICAgIGNvbnN0IGxlbmd0aCA9IHggKiB4ICsgeSAqIHk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBkZWx0YSBiZXR3ZWVuIGN1cnJlbnQgcG9zaXRpb24gYW5kIGxhc3QgcG9zaXRpb25cbiAgICAgIGNvbnN0IGRlbHRhID0gbGVuZ3RoIC0gdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmxlbmd0aDtcblxuICAgICAgLy8gTmFpdmUgaHlzdGVyZXNpc1xuICAgICAgaWYgKE1hdGguYWJzKGRlbHRhKSA8IDEwMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjZW50ZXIgYmV0d2VlbiB0b3VjaCBwb2ludHNcbiAgICAgIGNvbnN0IGNlbnRlclggPSBldmVudC50b3VjaGVzWzFdLnBhZ2VYICsgeCAvIDI7XG4gICAgICBjb25zdCBjZW50ZXJZID0gZXZlbnQudG91Y2hlc1sxXS5wYWdlWSArIHkgLyAyO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgem9vbSBjZW50ZXJcbiAgICAgIGNvbnN0IGZyYW1lRWxlbWVudE9mZnNldCA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50T2Zmc2V0KCk7XG4gICAgICBjb25zdCBjbGlja1BvaW50ID0ge1xuICAgICAgICB4OiBjZW50ZXJYIC0gZnJhbWVFbGVtZW50T2Zmc2V0LmxlZnQsXG4gICAgICAgIHk6IGNlbnRlclkgLSBmcmFtZUVsZW1lbnRPZmZzZXQudG9wXG4gICAgICB9O1xuICAgICAgdGhpcy5sYXN0Q2xpY2tQb2ludCA9IGNsaWNrUG9pbnQ7XG5cbiAgICAgIHRoaXMuY2hhbmdlWm9vbUxldmVsKCB0aGlzLmJhc2Uuem9vbUxldmVsICsgZGVsdGEgKiAwLjAwMDEsIGNsaWNrUG9pbnQgKTtcblxuICAgICAgLy8gVXBkYXRlIGxlbmd0aCBmb3IgbmV4dCBtb3ZlIGV2ZW50XG4gICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24gPSB7XG4gICAgICAgIGxlbmd0aDogbGVuZ3RoXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG5cblxuICBwcml2YXRlIG9uTW91c2VVcCA9IChldmVudCkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBvbk1vdXNldXAoKScsIGV2ZW50KTtcblxuICAgIGlmICgoZXZlbnQuYnV0dG9uICE9PSB0aGlzLmRyYWdNb3VzZUJ1dHRvbikgJiYgKGV2ZW50LnR5cGUgIT09ICd0b3VjaGVuZCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LnR5cGUgIT09ICd0b3VjaGVuZCcpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgY29uc3Qgbm93ID0gZXZlbnQudGltZVN0YW1wO1xuICAgIGNvbnN0IHRpbWVTaW5jZUxhc3RNb3VzZUV2ZW50ID0gKG5vdyAtIHRoaXMubGFzdE1vdXNlRXZlbnRUaW1lKSAvIDEwMDA7XG5cbiAgICBpZiAodGhpcy5wYW5WZWxvY2l0eSAmJiAodGhpcy5wYW5WZWxvY2l0eS54ICE9PSAwIHx8IHRoaXMucGFuVmVsb2NpdHkueSAhPT0gMCkgKSB7XG4gICAgICAvLyBhcHBseSBzdHJvbmcgaW5pdGlhbCBkYW1wZW5pbmcgaWYgdGhlIG1vdXNlIHVwIG9jY3VyZWQgbXVjaCBsYXRlciB0aGFuIHRoZSBsYXN0IG1vdXNlIG1vdmUsIGluZGljYXRpbmcgdGhhdCB0aGUgbW91c2UgaGFzbid0IG1vdmVkIHJlY2VudGx5XG4gICAgICAvLyBUQkQgLSBleHBlcmltZW50IHdpdGggdGhpcyBmb3JtdWxhXG4gICAgICBjb25zdCBpbml0aWFsTXVsdGlwbGllciA9IE1hdGgubWF4KFxuICAgICAgICAwLFxuICAgICAgICAtMC4yICsgTWF0aC5wb3codGltZVNpbmNlTGFzdE1vdXNlRXZlbnQgKyAxLCAtNClcbiAgICAgICAgKTtcblxuICAgICAgdGhpcy5wYW5WZWxvY2l0eS54ICo9IGluaXRpYWxNdWx0aXBsaWVyO1xuICAgICAgdGhpcy5wYW5WZWxvY2l0eS55ICo9IGluaXRpYWxNdWx0aXBsaWVyO1xuICAgICAgdGhpcy5kcmFnRmluaXNoaW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gdGhpcy5hbmltYXRpb25JZCA9IHRoaXMuYW5pbWF0aW9uRnJhbWVGdW5jKHRoaXMuYW5pbWF0aW9uVGljaykgKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLnBhblZlbG9jaXR5ID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kcmFnRmluaXNoaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLm1vZGVsLmlzUGFubmluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5jb25maWcubW9kZWxDaGFuZ2VkLm5leHQodGhpcy5tb2RlbCk7XG4gICAgICB0aGlzLnN5bmNCYXNlVG9Nb2RlbCgpO1xuICAgIH1cblxuICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhciggKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uVG91Y2hFbmQpICk7XG4gICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Ub3VjaE1vdmUsIDxhbnk+eyBwYXNzaXZlOiB0cnVlLCBjYXB0dXJlOiBmYWxzZSB9ICkgKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25Nb3VzZU1vdmUsIDxhbnk+eyBwYXNzaXZlOiB0cnVlLCBjYXB0dXJlOiBmYWxzZSB9ICkpO1xuICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXAsIDxhbnk+eyBwYXNzaXZlOiB0cnVlIH0gKSk7XG4gICAgfVxuXG4gICAgLy8gU2V0IHRoZSBvdmVybGF5IHRvIG5vbi1ibG9ja2luZyBhZ2FpbjpcbiAgICB0aGlzLnBhbnpvb21PdmVybGF5UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfVxuXG5cblxuICBwcml2YXRlIG9uVG91Y2hFbmQgPSAoZXZlbnQ6IGFueSkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBvblRvdWNoRW5kKCknKTtcbiAgICB0aGlzLm9uTW91c2VVcChldmVudCk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBvbkRibENsaWNrID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogb25EYmxDbGljaygpJyk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoIXRoaXMuY29uZmlnLnpvb21PbkRvdWJsZUNsaWNrKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZnJhbWVFbGVtZW50T2Zmc2V0ID0gdGhpcy5nZXRGcmFtZUVsZW1lbnRPZmZzZXQoKTtcbiAgICBjb25zdCBjbGlja1BvaW50OiBQb2ludCA9IHtcbiAgICAgIHg6IGV2ZW50LnBhZ2VYIC0gZnJhbWVFbGVtZW50T2Zmc2V0LmxlZnQsXG4gICAgICB5OiBldmVudC5wYWdlWSAtIGZyYW1lRWxlbWVudE9mZnNldC50b3BcbiAgICB9O1xuICAgIHRoaXMubGFzdENsaWNrUG9pbnQgPSBjbGlja1BvaW50O1xuICAgIHRoaXMuem9vbUluVG9Qb2ludChjbGlja1BvaW50KTtcbiAgfVxuXG5cblxuICBwcml2YXRlIHByZXZlbnREZWZhdWx0ID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cblxuXG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIEVWRU5UIEhBTkRMRVJTIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5cblxuXG5cblxuXG5cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBBUFBMWSBBTklNQVRJT05TIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cblxuICBwcml2YXRlIGFuaW1hdGlvblRpY2sgPSAodGltZXN0YW1wID0gcGVyZm9ybWFuY2Uubm93KCkpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogYW5pbWF0aW9uVGljaygpJyk7XG4gICAgLy8gdGltZXN0YW1wIGxvb2tzIGxpa2UgNzY5MTYuOTYzLiAgVGhlIHVuaXQgaXMgbWlsbGlzZWNvbmRzIGFuZCBzaG91bGQgYmUgYWNjdXJhdGUgdG8gNSDCtXMgKG1pY3Jvc2Vjb25kcylcblxuICAgIGxldCBkZWx0YVRpbWUgPSAwO1xuICAgIGlmICh0aGlzLmxhc3RUaWNrICE9PSAwKSB7XG4gICAgICBkZWx0YVRpbWUgPSAodGltZXN0YW1wIC0gdGhpcy5sYXN0VGljayk7IC8vIG9yaWcgLSBtaWxsaXNlY29uZHMgc2luY2UgdGhlIGxhc3QgYW5pbWF0aW9uVGlja1xuICAgIH1cbiAgICB0aGlzLmxhc3RUaWNrID0gdGltZXN0YW1wO1xuXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICAvLyB3aGVuIHdlJ3JlIHJ1bm5pbmcgYW4gYW5pbWF0aW9uIChidXQgbm90IHdhaXRpbmcgZm9yIGEgcmVsZWFzZWQgZHJhZyB0byBoYWx0KVxuICAgICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IGFuaW1hdGlvblRpY2soKTogbW9kZWwgaXMgem9vbWluZycpO1xuXG4gICAgICB0aGlzLmFuaW1hdGlvblBhcmFtcy5wcm9ncmVzcyArPSBNYXRoLmFicyhkZWx0YVRpbWUgLyB0aGlzLmFuaW1hdGlvblBhcmFtcy5kdXJhdGlvbik7XG5cbiAgICAgIGlmICh0aGlzLmFuaW1hdGlvblBhcmFtcy5wcm9ncmVzcyA+PSAxLjApIHtcbiAgICAgICAgLy8gT25seSB3aGVuIHRoZSBhbmltYXRpb24gaGFzIGZpbmlzaGVkLCBzeW5jIHRoZSBiYXNlIHRvIHRoZSBtb2RlbC5cbiAgICAgICAgdGhpcy5hbmltYXRpb25QYXJhbXMucHJvZ3Jlc3MgPSAxLjA7XG4gICAgICAgIHRoaXMudXBkYXRlRE9NKCk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uUGFyYW1zID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnBhblZlbG9jaXR5ICYmIHRoaXMuZHJhZ0ZpbmlzaGluZykge1xuICAgICAgLy8gVGhpcyBpcyB3aGVuIHdlJ3ZlIHBhbm5lZCBhbmQgcmVsZWFzZWQgdGhlIG1vdXNlIGJ1dHRvbiBhbmQgdGhlIHZpZXcgaXMgXCJmcmVlLWZsb2F0aW5nXCIgdW50aWwgaXQgc2xvd3MgdG8gYSBoYWx0LiAgRG9uJ3QgbGV0IHRoZSB3aGlsZSBsb29wIGZvb2wgeW91IC0gdGhpcyBvbmx5IGFwcGxpZXMgaXQgZm9yIHRoZSBjdXJyZW50IGZyYW1lLlxuICAgICAgLy8gUHJldmVudCBvdmVyc2hvb3RpbmcgaWYgZGVsdGEgdGltZSBpcyBsYXJnZSBmb3Igc29tZSByZWFzb24uIFdlIGFwcGx5IHRoZSBzaW1wbGUgc29sdXRpb24gb2Ygc2xpY2luZyBkZWx0YSB0aW1lIGludG8gc21hbGxlciBwaWVjZXMgYW5kIGFwcGx5aW5nIGVhY2ggb25lXG4gICAgICBpZiAoZGVsdGFUaW1lID4gMCkge1xuICAgICAgICBkZWx0YVRpbWUgPSBkZWx0YVRpbWUgLyAxMDAwO1xuICAgICAgfVxuICAgICAgd2hpbGUgKGRlbHRhVGltZSA+IDApIHtcbiAgICAgICAgY29uc3QgZFRpbWUgPSBNYXRoLm1pbiguMDIsIGRlbHRhVGltZSk7XG4gICAgICAgIGRlbHRhVGltZSA9IGRlbHRhVGltZSAtIGRUaW1lO1xuXG4gICAgICAgIHRoaXMubW9kZWwucGFuLnggPSB0aGlzLm1vZGVsLnBhbi54ICsgdGhpcy5wYW5WZWxvY2l0eS54ICogZFRpbWU7XG4gICAgICAgIHRoaXMucGFuVmVsb2NpdHkueCA9IHRoaXMucGFuVmVsb2NpdHkueCAqICgxIC0gdGhpcy5jb25maWcuZnJpY3Rpb24gKiBkVGltZSk7XG5cbiAgICAgICAgdGhpcy5tb2RlbC5wYW4ueSA9IHRoaXMubW9kZWwucGFuLnkgKyB0aGlzLnBhblZlbG9jaXR5LnkgKiBkVGltZTtcbiAgICAgICAgdGhpcy5wYW5WZWxvY2l0eS55ID0gdGhpcy5wYW5WZWxvY2l0eS55ICogKDEgLSB0aGlzLmNvbmZpZy5mcmljdGlvbiAqIGRUaW1lKTtcblxuICAgICAgICBjb25zdCBzcGVlZCA9IHRoaXMubGVuZ3RoKHRoaXMucGFuVmVsb2NpdHkpO1xuXG4gICAgICAgIGlmIChzcGVlZCA8PSB0aGlzLmNvbmZpZy5oYWx0U3BlZWQpIHtcbiAgICAgICAgICB0aGlzLnBhblZlbG9jaXR5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHRoaXMuZHJhZ0ZpbmlzaGluZyA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb25maWcua2VlcEluQm91bmRzIHx8IHRoaXMuZHJhZ0ZpbmlzaGluZykge1xuICAgICAgLy8gQ2hlY2tzIHRoYXQga2VlcEluQm91bmRzIGlzIHNldCBhbmQgdGhhdCB0aGUgbW91c2UgYnV0dG9uIGlzbid0IHByZXNzZWQsIGFuZCBpZiBzbywgaXQgc3RvcHMgdGhlIGNvbnRlbnRzIGZyb20gZ29pbmcgb3V0IG9mIHZpZXdcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBhbmltYXRpb25UaWNrKCk6IGtlZXBJbkJvdW5kcycpO1xuICAgICAgY29uc3QgdG9wTGVmdENvcm5lclZpZXcgPSB0aGlzLmdldFZpZXdQb3NpdGlvbih7IHg6IDAsIHk6IDAgfSk7XG4gICAgICBjb25zdCBib3R0b21SaWdodENvcm5lclZpZXcgPSB0aGlzLmdldFZpZXdQb3NpdGlvbih7IHg6IHRoaXMuY29udGVudFdpZHRoLCB5OiB0aGlzLmNvbnRlbnRIZWlnaHQgfSk7XG5cbiAgICAgIGlmICh0b3BMZWZ0Q29ybmVyVmlldy54ID4gMCkge1xuICAgICAgICB0aGlzLmJhc2UucGFuLnggLT0gdGhpcy5jb25maWcua2VlcEluQm91bmRzUmVzdG9yZUZvcmNlICogdG9wTGVmdENvcm5lclZpZXcueDtcbiAgICAgIH1cblxuICAgICAgaWYgKHRvcExlZnRDb3JuZXJWaWV3LnkgPiAwKSB7XG4gICAgICAgIHRoaXMuYmFzZS5wYW4ueSAtPSB0aGlzLmNvbmZpZy5rZWVwSW5Cb3VuZHNSZXN0b3JlRm9yY2UgKiB0b3BMZWZ0Q29ybmVyVmlldy55O1xuICAgICAgfVxuXG4gICAgICBpZiAoYm90dG9tUmlnaHRDb3JuZXJWaWV3LnggPCB0aGlzLmNvbnRlbnRXaWR0aCkge1xuICAgICAgICB0aGlzLmJhc2UucGFuLnggLT0gdGhpcy5jb25maWcua2VlcEluQm91bmRzUmVzdG9yZUZvcmNlICogKGJvdHRvbVJpZ2h0Q29ybmVyVmlldy54IC0gdGhpcy5jb250ZW50V2lkdGgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYm90dG9tUmlnaHRDb3JuZXJWaWV3LnkgPCB0aGlzLmNvbnRlbnRIZWlnaHQpIHtcbiAgICAgICAgdGhpcy5iYXNlLnBhbi55IC09IHRoaXMuY29uZmlnLmtlZXBJbkJvdW5kc1Jlc3RvcmVGb3JjZSAqIChib3R0b21SaWdodENvcm5lclZpZXcueSAtIHRoaXMuY29udGVudEhlaWdodCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVET00oKTtcbiAgICB0aGlzLmNvbmZpZy5tb2RlbENoYW5nZWQubmV4dCh0aGlzLm1vZGVsKTtcblxuXG4gICAgaWYgKCB0aGlzLmFuaW1hdGlvblBhcmFtcyB8fCAodGhpcy5wYW5WZWxvY2l0eSAmJiB0aGlzLmRyYWdGaW5pc2hpbmcpICkge1xuICAgICAgLy8gSXMgYW4gYW5pbWF0aW9uIGFjdGl2ZT8gIElmIHNvLCBydW4gdGhlIG5leHQgZnJhbWVcblxuICAgICAgaWYgKHRoaXMuaXNDaHJvbWUgJiYgdGhpcy56b29tTGV2ZWxJc0NoYW5naW5nKSB7XG4gICAgICAgIC8vIHJ1biB3aWxsLWNoYW5nZSB0b2dnbGUgaGFjayBvbiBDaHJvbWUgdG8gdHJpZ2dlciByZS1yYXN0ZXJpemF0aW9uXG4gICAgICAgIC8vIHNlZSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS93ZWIvdXBkYXRlcy8yMDE2LzA5L3JlLXJhc3RlcmluZy1jb21wb3NpdGVcbiAgICAgICAgaWYgKHRoaXMud2lsbENoYW5nZU5leHRGcmFtZSkge1xuICAgICAgICAgIHRoaXMuem9vbUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWxsQ2hhbmdlID0gJ2F1dG8nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuem9vbUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWxsQ2hhbmdlID0gJ3RyYW5zZm9ybSc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53aWxsQ2hhbmdlTmV4dEZyYW1lID0gIXRoaXMud2lsbENoYW5nZU5leHRGcmFtZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVGdW5jKHRoaXMuYW5pbWF0aW9uVGljayk7IC8vIENhbGwgdGhlIG5leHQgYW5pbWF0aW9uIGZyYW1lXG4gICAgfVxuXG4gICAgZWxzZSBpZiAodGhpcy5wYW5WZWxvY2l0eSAmJiAhdGhpcy5kcmFnRmluaXNoaW5nKSB7XG4gICAgICAvLyB3ZSdyZSBqdXN0IG1vdXNlLXBhbm5pbmcgdGhlIGZyYW1lLiAgV2UgZG9uJ3QgbmVlZCBhbm90aGVyIHRpY2tcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbHNlIHtcbiAgICAgIC8vIEFuaW1hdGlvbiBoYXMgZW5kZWRcbiAgICAgIGlmICh0aGlzLm1vZGVsLmlzUGFubmluZykge1xuICAgICAgICB0aGlzLm1vZGVsLmlzUGFubmluZyA9IGZhbHNlO1xuICAgICAgfSBcbiAgICAgIHRoaXMuc3luY0Jhc2VUb01vZGVsKCk7XG4gICAgICB0aGlzLmNvbmZpZy5tb2RlbENoYW5nZWQubmV4dCh0aGlzLm1vZGVsKTtcbiAgICAgIHRoaXMuc2NhbGUgPSB0aGlzLmdldENzc1NjYWxlKHRoaXMuYmFzZS56b29tTGV2ZWwpO1xuICAgICAgdGhpcy53aWxsQ2hhbmdlTmV4dEZyYW1lID0gdHJ1ZTtcbiAgICAgIHRoaXMuem9vbUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWxsQ2hhbmdlID0gJ3RyYW5zZm9ybSc7XG4gICAgICB0aGlzLnpvb21MZXZlbElzQ2hhbmdpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMubGFzdFRpY2sgPSAwO1xuICAgIH1cblxuICB9XG5cblxuXG4gIHByaXZhdGUgdXBkYXRlRE9NKCkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiB1cGRhdGVET00oKScpO1xuICAgIC8vIENhbGxlZCBieSBuZ0FmdGVyVmlld0luaXQoKSBhbmQgYW5pbWF0aW9uVGljaygpXG4gICAgLy8gVGhpcyBmdW5jdGlvbiBkb2VzIG5vdCBnZXQgY2FsbGVkIGJ5IGZyZWVab29tKCksIHdoaWNoIG9wZXJhdGVzIGluZGVwZW5kZW50bHkgb2YgYW5pbWF0aW9uVGljaygpIGFuZCB1cGRhdGVET00oKS5cblxuICAgIGlmICh0aGlzLmFuaW1hdGlvblBhcmFtcykge1xuICAgICAgLy8gd2UncmUgcnVubmluZyBhbiBhbmltYXRpb24gc2VxdWVuY2UgKGJ1dCBub3QgZnJlZVpvb21pbmcgb3IgcGFubmluZyB3aXRoIG9uTW91c2VNb3ZlKCkgKVxuICAgICAgdGhpcy5tb2RlbC56b29tTGV2ZWwgPSB0aGlzLmJhc2Uuem9vbUxldmVsICsgdGhpcy5hbmltYXRpb25QYXJhbXMuZGVsdGFab29tTGV2ZWwgKiB0aGlzLmFuaW1hdGlvblBhcmFtcy5wcm9ncmVzczsgLy8gY2FsY3VsYXRlIGhvdyBmYXIgd2UgbmVlZCB0byB6b29tIGluIG9yIG91dCBmb3IgdGhlIGN1cnJlbnQgYW5pbWF0aW9uVGlja1xuICAgICAgY29uc3QgZGVsdGFUcmFuc2xhdGlvbiA9IHRoaXMuYW5pbWF0aW9uUGFyYW1zLnBhblN0ZXBGdW5jKHRoaXMubW9kZWwuem9vbUxldmVsKTsgLy8gY2FsY3VsYXRlIGhvdyBmYXIgdG8gcGFuIHRoZSB2aWV3IHRvIGJhc2VkIG9uIG91ciB0cmFuc2xhdGVkIGNvb3JkaW5hdGVzXG5cbiAgICAgIC8vIHN5bmMgdGhlIG1vZGVsIHBhbiBjb29yZGluYXRlcyB0byBvdXIgdHJhbnNsYXRlZCBwYW4gY29vcmRpbmF0ZXNcbiAgICAgIC8vIHdlIGRvIHRoaXMgYnkgYWRkaW5nIGhvdyBmYXIgd2Ugd2FudCB0byBtb3ZlIGluIGVhY2ggZGlyZWN0aW9uIHRvIG91ciBvdXIgZXhpc3RpbmcgYmFzZSBwYW4gY29vcmRpbmF0ZXMgKHdoZXJlIHdlIHN0YXJ0ZWQpXG4gICAgICB0aGlzLm1vZGVsLnBhbi54ID0gdGhpcy5iYXNlLnBhbi54ICsgZGVsdGFUcmFuc2xhdGlvbi54O1xuICAgICAgdGhpcy5tb2RlbC5wYW4ueSA9IHRoaXMuYmFzZS5wYW4ueSArIGRlbHRhVHJhbnNsYXRpb24ueTtcblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmtlZXBJbkJvdW5kcykge1xuICAgICAgICBjb25zdCB0b3BMZWZ0Q29ybmVyVmlldyA9IHRoaXMuZ2V0Vmlld1Bvc2l0aW9uKHsgeDogMCwgeTogMCB9KTtcbiAgICAgICAgY29uc3QgYm90dG9tUmlnaHRDb3JuZXJWaWV3ID0gdGhpcy5nZXRWaWV3UG9zaXRpb24oeyB4OiB0aGlzLmNvbnRlbnRXaWR0aCwgeTogdGhpcy5jb250ZW50SGVpZ2h0IH0pO1xuXG4gICAgICAgIGlmICh0b3BMZWZ0Q29ybmVyVmlldy54ID4gMCkge1xuICAgICAgICAgIHRoaXMubW9kZWwucGFuLnggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRvcExlZnRDb3JuZXJWaWV3LnkgPiAwKSB7XG4gICAgICAgICAgdGhpcy5tb2RlbC5wYW4ueSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYm90dG9tUmlnaHRDb3JuZXJWaWV3LnggPCB0aGlzLmNvbnRlbnRXaWR0aCkge1xuICAgICAgICAgIHRoaXMubW9kZWwucGFuLnggLT0gKGJvdHRvbVJpZ2h0Q29ybmVyVmlldy54IC0gdGhpcy5jb250ZW50V2lkdGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGJvdHRvbVJpZ2h0Q29ybmVyVmlldy55IDwgdGhpcy5jb250ZW50SGVpZ2h0KSB7XG4gICAgICAgICAgdGhpcy5tb2RlbC5wYW4ueSAtPSAoYm90dG9tUmlnaHRDb3JuZXJWaWV3LnkgLSB0aGlzLmNvbnRlbnRIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vIEFQUExZIFNDQUxJTkcgLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zIHx8IHRoaXMuaXNGaXJzdFN5bmMpIHtcbiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5nZXRDc3NTY2FsZSh0aGlzLm1vZGVsLnpvb21MZXZlbCk7XG4gICAgICBjb25zdCBzY2FsZVN0cmluZyA9IGBzY2FsZSgke3NjYWxlfSlgO1xuICAgICAgY29uc3Qgem9vbVN0eWxlID0gYHRyYW5zZm9ybS1vcmlnaW46IDAgMDsgdHJhbnNmb3JtOiAke3NjYWxlU3RyaW5nfTtgO1xuICAgICAgdGhpcy56b29tRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB6b29tU3R5bGUpO1xuICAgIH1cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLy8vLy8vLy8vLy8vLy8vIEFQUExZIFBBTiBBTklNQVRJT04gLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIGNvbnN0IHRyYW5zbGF0ZTNkID0gYHRyYW5zbGF0ZTNkKCR7dGhpcy5tb2RlbC5wYW4ueH1weCwgJHt0aGlzLm1vZGVsLnBhbi55fXB4LCAwKWA7XG4gICAgdGhpcy5wYW5FbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNsYXRlM2Q7XG5cbiAgfVxuXG5cblxuICBwcml2YXRlIGZyZWVab29tKGNsaWNrUG9pbnQ6IFBvaW50LCB3aGVlbERlbHRhOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogZnJlZVpvb20oKTogdGhpcy5iYXNlOicsIHRoaXMuYmFzZSk7XG5cbiAgICBpZiAodGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICAvLyBkb24ndCBhbGxvdyB6b29taW5nIGlmIHRoZSBtb3VzZSBpcyBkb3duXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gbm93IGhhbmRsZSBpbnRlcnJ1cHRpb24gb2YgYW4gaW4tcHJvZ3Jlc3MgYW5pbWF0aW9uXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICB0aGlzLmFuaW1hdGlvblBhcmFtcyA9IHVuZGVmaW5lZDsgLy8gY2FuY2VsIGFuIGV4aXN0aW5nIGFuaW1hdGlvblxuICAgIH1cblxuICAgIGlmICh0aGlzLnBhblZlbG9jaXR5KSB7XG4gICAgICB0aGlzLmRyYWdGaW5pc2hpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMucGFuVmVsb2NpdHkgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgY29uc3QgY3VycmVudFBhbjogUG9pbnQgPSB7XG4gICAgICAvLyB0aGUgY3VycmVudCBtb2RlbCBjb29yZGluYXRlc1xuICAgICAgeDogdGhpcy5tb2RlbC5wYW4ueCxcbiAgICAgIHk6IHRoaXMubW9kZWwucGFuLnlcbiAgICB9O1xuICAgIGNvbnN0IGN1cnJlbnRTY2FsZSA9IHRoaXMuc2NhbGU7IC8vIGdldCB0aGUgY3VycmVudCBDU1Mgc2NhbGUgKHNjYWxlMClcblxuICAgIGxldCBuZXdTY2FsZSA9IHRoaXMuc2NhbGUgKyAod2hlZWxEZWx0YSAqIHRoaXMuY29uZmlnLmZyZWVNb3VzZVdoZWVsRmFjdG9yICogdGhpcy5zY2FsZSk7XG5cbiAgICAvLyB0YWtlcyBlaXRoZXIgdGhlIG1pbmltdW0gc2NhbGUgKGZ1cnRoZXN0IGFsbG93YWJsZSB6b29tZWQgb3V0KSBvciB0aGUgY2FsY3VsYXRlZCBjdXJyZW50IHNjYWxlLCB3aGljaGV2ZXIgaXMgZ3JlYXRlciwgdW5sZXNzIGNhbGN1bGF0ZWQgY3VycmVudCBzY2FsZSBleGNlZWRzIG1heFNjYWxlIChmdXJ0aGVzdCBhbGxvd2FibGUgem9vbWVkIGluKSwgaW4gd2hpY2ggY2FzZSBtYXhTY2FsZSBpcyB1c2VkXG4gICAgbmV3U2NhbGUgPSBNYXRoLm1heCh0aGlzLm1pblNjYWxlLCBNYXRoLm1pbiggdGhpcy5tYXhTY2FsZSwgbmV3U2NhbGUgKSk7XG4gICAgdGhpcy5zY2FsZSA9IG5ld1NjYWxlO1xuXG4gICAgY29uc3QgdGFyZ2V0UG9pbnQ6IFBvaW50ID0ge1xuICAgICAgLy8gVGhlIHRhcmdldCBwb2ludCB0byB6b29tIHRvLiAgSXQgbXVzdCBzdGF5IHRoZSBzYW1lIGFzIHRoZSB1bnRyYW5zbGF0ZWQgcG9pbnRcbiAgICAgIHg6IGNsaWNrUG9pbnQueCAtIChuZXdTY2FsZSAvIGN1cnJlbnRTY2FsZSkgKiAoY2xpY2tQb2ludC54IC0gY3VycmVudFBhbi54KSxcbiAgICAgIHk6IGNsaWNrUG9pbnQueSAtIChuZXdTY2FsZSAvIGN1cnJlbnRTY2FsZSkgKiAoY2xpY2tQb2ludC55IC0gY3VycmVudFBhbi55KVxuICAgIH07XG5cbiAgICAvLyBBcHBseSBQYW4gJiBTY2FsZVxuICAgIGNvbnN0IHRyYW5zbGF0ZTNkID0gYHRyYW5zbGF0ZTNkKCR7dGFyZ2V0UG9pbnQueH1weCwgJHt0YXJnZXRQb2ludC55fXB4LCAwKWA7XG4gICAgdGhpcy5wYW5FbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNsYXRlM2Q7XG4gICAgXG4gICAgY29uc3Qgc2NhbGVTdHJpbmcgPSBgc2NhbGUoJHt0aGlzLnNjYWxlfSlgO1xuICAgIGxldCB6b29tU3R5bGUgPSBgdHJhbnNmb3JtLW9yaWdpbjogMCAwOyB0cmFuc2Zvcm06ICR7c2NhbGVTdHJpbmd9O2A7XG4gICAgaWYgKHRoaXMuaXNDaHJvbWUpIHtcbiAgICAgIGlmICh0aGlzLndpbGxDaGFuZ2VOZXh0RnJhbWUpIHtcbiAgICAgICAgem9vbVN0eWxlICs9IGAgd2lsbC1jaGFuZ2U6IGF1dG87YDtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB6b29tU3R5bGUgKz0gYCB3aWxsLWNoYW5nZTogdHJhbnNmb3JtO2A7XG4gICAgICB9XG4gICAgICB0aGlzLndpbGxDaGFuZ2VOZXh0RnJhbWUgPSAhdGhpcy53aWxsQ2hhbmdlTmV4dEZyYW1lO1xuICAgIH1cblxuICAgIC8vIGFwcGx5IHpvb20gY3NzXG4gICAgdGhpcy56b29tRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB6b29tU3R5bGUpO1xuXG4gICAgdGhpcy5tb2RlbC5wYW4ueCA9IHRhcmdldFBvaW50Lng7XG4gICAgdGhpcy5tb2RlbC5wYW4ueSA9IHRhcmdldFBvaW50Lnk7XG4gICAgdGhpcy5tb2RlbC56b29tTGV2ZWwgPSB0aGlzLmdldFpvb21MZXZlbCh0aGlzLnNjYWxlKTtcbiAgICB0aGlzLmNvbmZpZy5tb2RlbENoYW5nZWQubmV4dCh0aGlzLm1vZGVsKTtcbiAgICB0aGlzLnN5bmNCYXNlVG9Nb2RlbCgpO1xuICB9XG5cblxuXG5cblxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8vLy8vLy8vLy8vLy8vLyBIRUxQRVIgRlVOQ1RJT05TIC8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuXG4gIHByaXZhdGUgaXNNb2JpbGVEZXZpY2UoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICh0eXBlb2Ygd2luZG93Lm9yaWVudGF0aW9uICE9PSAndW5kZWZpbmVkJykgfHwgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignSUVNb2JpbGUnKSAhPT0gLTEpO1xuICB9XG5cblxuXG4gIHByaXZhdGUgc3luY0Jhc2VUb01vZGVsKCkge1xuICAgIHRoaXMuYmFzZS5wYW4ueCA9IHRoaXMubW9kZWwucGFuLng7XG4gICAgdGhpcy5iYXNlLnBhbi55ID0gdGhpcy5tb2RlbC5wYW4ueTtcbiAgICB0aGlzLmJhc2Uuem9vbUxldmVsID0gdGhpcy5tb2RlbC56b29tTGV2ZWw7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBsZW5ndGgodmVjdG9yMmQ6IGFueSkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBsZW5ndGgoKScpO1xuICAgIHJldHVybiBNYXRoLnNxcnQodmVjdG9yMmQueCAqIHZlY3RvcjJkLnggKyB2ZWN0b3IyZC55ICogdmVjdG9yMmQueSk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBnZXRDZW50cmVQb2ludCgpOiBQb2ludCB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IGdldENlbnRyZVBvaW50KCknKTtcbiAgICByZXR1cm4ge1xuICAgICAgeDogdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCAvIDIsXG4gICAgICB5OiB0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCAvIDJcbiAgICB9O1xuICB9XG5cblxuXG4gIHByaXZhdGUgZ2V0Q3NzU2NhbGUoem9vbUxldmVsOiBhbnkpOiBudW1iZXIge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBnZXRDc3NTY2FsZSgpJyk7XG4gICAgcmV0dXJuIE1hdGgucG93KHRoaXMuY29uZmlnLnNjYWxlUGVyWm9vbUxldmVsLCB6b29tTGV2ZWwgLSB0aGlzLmNvbmZpZy5uZXV0cmFsWm9vbUxldmVsKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIGdldFpvb21MZXZlbChjc3NTY2FsZTogYW55KSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IGdldFpvb21MZXZlbCgpJyk7XG4gICAgcmV0dXJuIE1hdGgubG9nMTAoY3NzU2NhbGUpIC8gTWF0aC5sb2cxMCh0aGlzLmNvbmZpZy5zY2FsZVBlclpvb21MZXZlbCkgKyB0aGlzLmNvbmZpZy5uZXV0cmFsWm9vbUxldmVsO1xuICB9XG5cblxuXG4gIHByaXZhdGUgY2FsY1pvb21Ub0ZpdChyZWN0OiBSZWN0KTogUGFuWm9vbU1vZGVsIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogY2FsY1pvb21Ub0ZpdCgpOiByZWN0OicsIHJlY3QpO1xuICAgIC8vIGxldCAoVywgSCkgZGVub3RlIHRoZSBzaXplIG9mIHRoZSB2aWV3cG9ydFxuICAgIC8vIGxldCAodywgaCkgZGVub3RlIHRoZSBzaXplIG9mIHRoZSByZWN0YW5nbGUgdG8gem9vbSB0b1xuICAgIC8vIHRoZW4gd2UgbXVzdCBDU1Mgc2NhbGUgYnkgdGhlIG1pbiBvZiBXL3cgYW5kIEgvaCBpbiBvcmRlciB0byBqdXN0IGZpdCB0aGUgcmVjdGFuZ2xlXG4gICAgLy8gcmV0dXJucyB0aGUgdGFyZ2V0IGxlZnQgYW5kIHRvcCBjb29yZGluYXRlcyBmb3IgdGhlIHBhbkVsZW1lbnQgYW5kIHRhcmdldCB6b29tTGV2ZWxcblxuICAgIGNvbnN0IHZpZXdwb3J0V2lkdGggPSB0aGlzLmZyYW1lRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cbiAgICBjb25zdCB0YXJnZXRXaWR0aCA9IHJlY3Qud2lkdGg7XG4gICAgY29uc3QgdGFyZ2V0SGVpZ2h0ID0gcmVjdC5oZWlnaHQ7XG5cbiAgICBjb25zdCBjc3NTY2FsZUV4YWN0ID0gTWF0aC5taW4oIHZpZXdwb3J0V2lkdGggLyB0YXJnZXRXaWR0aCwgdmlld3BvcnRIZWlnaHQgLyB0YXJnZXRIZWlnaHQgKTtcbiAgICBjb25zdCB6b29tTGV2ZWxFeGFjdCA9IHRoaXMuZ2V0Wm9vbUxldmVsKGNzc1NjYWxlRXhhY3QpO1xuICAgIGNvbnN0IHpvb21MZXZlbCA9IHpvb21MZXZlbEV4YWN0ICogdGhpcy5jb25maWcuem9vbVRvRml0Wm9vbUxldmVsRmFjdG9yO1xuICAgIGNvbnN0IGNzc1NjYWxlID0gdGhpcy5nZXRDc3NTY2FsZSh6b29tTGV2ZWwpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgem9vbUxldmVsOiB6b29tTGV2ZWwsXG4gICAgICAgIHBhbjoge1xuICAgICAgICAgICAgeDogLXJlY3QueCAqIGNzc1NjYWxlICsgKHZpZXdwb3J0V2lkdGggLSB0YXJnZXRXaWR0aCAqIGNzc1NjYWxlKSAvIDIsXG4gICAgICAgICAgICB5OiAtcmVjdC55ICogY3NzU2NhbGUgKyAodmlld3BvcnRIZWlnaHQgLSB0YXJnZXRIZWlnaHQgKiBjc3NTY2FsZSkgLyAyXG4gICAgICAgIH1cbiAgICB9O1xuICB9XG5cblxuXG4gIHByaXZhdGUgem9vbVRvRml0TW9kZWwodGFyZ2V0OiBQYW5ab29tTW9kZWwsIGR1cmF0aW9uOiBudW1iZXIgPSB1bmRlZmluZWQpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogem9vbVRvRml0TW9kZWwoKTogdGFyZ2V0OicsIHRhcmdldCk7XG5cbiAgICAvLyB0YXJnZXQucGFuLnggaXMgdGhlIHBhbkVsZW1lbnQgbGVmdCBzdHlsZSBwcm9wZXJ0eVxuICAgIC8vIHRhcmdldC5wYW4ueSBpcyB0aGUgcGFuRWxlbWVudCB0b3Agc3R5bGUgcHJvcGVydHlcbiAgICB0aGlzLm1vZGVsLmlzUGFubmluZyA9IHRydWU7XG4gICAgdGhpcy5hbmltYXRlVG9UYXJnZXQodGFyZ2V0LCBkdXJhdGlvbik7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSB6b29tVG9MZXZlbEFuZFBvaW50KGxldmVsOiBudW1iZXIsIGNsaWNrUG9pbnQ6IFBvaW50KSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IHpvb21Ub0xldmVsQW5kUG9pbnQoKTogbGV2ZWw6JywgbGV2ZWwpO1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiB6b29tVG9MZXZlbEFuZFBvaW50KCk6IGNsaWNrUG9pbnQ6JywgY2xpY2tQb2ludCk7XG4gICAgdGhpcy5jaGFuZ2Vab29tTGV2ZWwoIGxldmVsLCBjbGlja1BvaW50ICk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSB6b29tSW4oem9vbVR5cGU6IFpvb21UeXBlID0gJ2xhc3RQb2ludCcpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogem9vbUluKCknKTtcbiAgICBpZiAoem9vbVR5cGUgPT09ICdsYXN0UG9pbnQnKSB7XG4gICAgICB0aGlzLmNoYW5nZVpvb21MZXZlbCggdGhpcy5iYXNlLnpvb21MZXZlbCArIHRoaXMuY29uZmlnLnpvb21CdXR0b25JbmNyZW1lbnQsIHRoaXMubGFzdENsaWNrUG9pbnQgKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoem9vbVR5cGUgPT09ICd2aWV3Q2VudGVyJykge1xuICAgICAgdGhpcy5jaGFuZ2Vab29tTGV2ZWwoIHRoaXMuYmFzZS56b29tTGV2ZWwgKyB0aGlzLmNvbmZpZy56b29tQnV0dG9uSW5jcmVtZW50LCB0aGlzLmdldENlbnRyZVBvaW50KCkgKTtcbiAgICB9XG4gICAgXG4gIH1cblxuXG5cbiAgcHJpdmF0ZSB6b29tT3V0KHpvb21UeXBlOiBab29tVHlwZSA9ICdsYXN0UG9pbnQnKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IHpvb21PdXQoKScpO1xuICAgIGlmICh6b29tVHlwZSA9PT0gJ2xhc3RQb2ludCcpIHtcbiAgICAgIHRoaXMuY2hhbmdlWm9vbUxldmVsKCB0aGlzLmJhc2Uuem9vbUxldmVsIC0gdGhpcy5jb25maWcuem9vbUJ1dHRvbkluY3JlbWVudCwgdGhpcy5sYXN0Q2xpY2tQb2ludCApO1xuICAgIH1cbiAgICBlbHNlIGlmICh6b29tVHlwZSA9PT0gJ3ZpZXdDZW50ZXInKSB7XG4gICAgICB0aGlzLmNoYW5nZVpvb21MZXZlbCggdGhpcy5iYXNlLnpvb21MZXZlbCAtIHRoaXMuY29uZmlnLnpvb21CdXR0b25JbmNyZW1lbnQsIHRoaXMuZ2V0Q2VudHJlUG9pbnQoKSApO1xuICAgIH1cbiAgfVxuXG5cblxuICBwcml2YXRlIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgIHRoaXMubGFzdFRpY2sgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoICgpID0+IHRoaXMuYW5pbWF0aW9uSWQgPSB0aGlzLmFuaW1hdGlvbkZyYW1lRnVuYyh0aGlzLmFuaW1hdGlvblRpY2spICk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBnZXRGcmFtZUVsZW1lbnRPZmZzZXQoKTogT2Zmc2V0IHtcbiAgICBjb25zdCByZWN0ID0gdGhpcy5mcmFtZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiByZWN0LnRvcCArIHdpbmRvdy5zY3JvbGxZLFxuICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgd2luZG93LnNjcm9sbFhcbiAgICB9O1xuICB9XG5cblxuXG4gIHByaXZhdGUgb25Db250ZW50RGltZW5zaW9uc0NoYW5nZURldGVjdGVkKGVudHJpZXM6IGFueVtdKSB7XG4gICAgLy8gY2FsbGJhY2sgZm9yIFJlc2l6ZU9ic2VydmVyXG4gICAgdGhpcy5jb250ZW50SGVpZ2h0ID0gZW50cmllc1swXS5jb250ZW50UmVjdC5oZWlnaHQ7XG4gICAgdGhpcy5jb250ZW50V2lkdGggPSBlbnRyaWVzWzBdLmNvbnRlbnRSZWN0LndpZHRoO1xuICB9XG5cblxuXG5cblxuXG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vIEFQSSBNRVRIT0RTIC8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5cbiAgcHJpdmF0ZSBnZXRWaWV3UG9zaXRpb24obW9kZWxQb3NpdGlvbjogUG9pbnQpOiBQb2ludCB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IGdldFZpZXdQb3NpdGlvbigpJyk7XG4gICAgLy8gcCcgPSBwICogcyArIHRcbiAgICAvLyB2aWV3UG9zaXRpb24gPSBtb2RlbFBvc2l0aW9uICogc2NhbGUgKyBiYXNlUGFuXG5cbiAgICBsZXQgc2NhbGUsIHRyYW5zbGF0aW9uO1xuXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICBzY2FsZSA9IHRoaXMuZ2V0Q3NzU2NhbGUodGhpcy5iYXNlLnpvb21MZXZlbCArIHRoaXMuYW5pbWF0aW9uUGFyYW1zLmRlbHRhWm9vbUxldmVsICogdGhpcy5hbmltYXRpb25QYXJhbXMucHJvZ3Jlc3MpO1xuICAgICAgbGV0IGRlbHRhVHJhbnNsYXRpb24gPSB0aGlzLmFuaW1hdGlvblBhcmFtcy5wYW5TdGVwRnVuYyh0aGlzLm1vZGVsLnpvb21MZXZlbCk7XG4gICAgICB0cmFuc2xhdGlvbiA9IHtcbiAgICAgICAgeDogdGhpcy5iYXNlLnBhbi54ICsgZGVsdGFUcmFuc2xhdGlvbi54LFxuICAgICAgICB5OiB0aGlzLmJhc2UucGFuLnkgKyBkZWx0YVRyYW5zbGF0aW9uLnlcbiAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2NhbGUgPSB0aGlzLmdldENzc1NjYWxlKHRoaXMuYmFzZS56b29tTGV2ZWwpO1xuICAgICAgdHJhbnNsYXRpb24gPSB0aGlzLmJhc2UucGFuO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB4OiBtb2RlbFBvc2l0aW9uLnggKiBzY2FsZSArIHRyYW5zbGF0aW9uLngsXG4gICAgICB5OiBtb2RlbFBvc2l0aW9uLnkgKiBzY2FsZSArIHRyYW5zbGF0aW9uLnlcbiAgICB9O1xuICB9XG5cblxuXG4gIHByaXZhdGUgZ2V0TW9kZWxQb3NpdGlvbih2aWV3UG9zaXRpb246IFBvaW50KTogUG9pbnQge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBnZXRNb2RlbFBvc2l0aW9uKCknKTtcbiAgICAvLyBwID0gKDEvcykocCcgLSB0KVxuICAgIGNvbnN0IHBtYXJrID0gdmlld1Bvc2l0aW9uO1xuICAgIGNvbnN0IHMgPSB0aGlzLmdldENzc1NjYWxlKHRoaXMuYmFzZS56b29tTGV2ZWwpO1xuICAgIGNvbnN0IHQgPSB0aGlzLmJhc2UucGFuO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHg6ICgxIC8gcykgKiAocG1hcmsueCAtIHQueCksXG4gICAgICB5OiAoMSAvIHMpICogKHBtYXJrLnkgLSB0LnkpXG4gICAgfTtcbiAgfVxuXG5cblxuICBwcml2YXRlIHJlc2V0VmlldygpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogcmVzZXRWaWV3KCknKTtcbiAgICBpZiAodGhpcy5jb25maWcuaW5pdGlhbFpvb21Ub0ZpdCkge1xuICAgICAgdGhpcy56b29tVG9GaXQodGhpcy5jb25maWcuaW5pdGlhbFpvb21Ub0ZpdCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRoaXMuY29uZmlnLmluaXRpYWxQYW5YICE9PSB1bmRlZmluZWQgJiYgdGhpcy5jb25maWcuaW5pdGlhbFBhblkgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmNvbmZpZy5pbml0aWFsWm9vbUxldmVsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuem9vbVRvRml0TW9kZWwoXG4gICAgICAgIHtcbiAgICAgICAgICB6b29tTGV2ZWw6IHRoaXMuY29uZmlnLmluaXRpYWxab29tTGV2ZWwsXG4gICAgICAgICAgcGFuOiB7XG4gICAgICAgICAgICB4OiB0aGlzLmNvbmZpZy5pbml0aWFsUGFuWCxcbiAgICAgICAgICAgIHk6IHRoaXMuY29uZmlnLmluaXRpYWxQYW5ZXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Bhblpvb21Db21wb25lbnQ6IHJlc2V0VmlldygpIGNvdWxkIG5vdCByZXNldCB2aWV3IGFzIHNvbWUgdmFycyB3ZXJlIG5vdCBzZXQuICBUaGUgY3VscHJpdHMgYXJlIGVpdGhlciBjb25maWcuaW5pdGlhbFpvb21MZXZlbCwgY29uZmlnLmluaXRpYWxQYW5YLCBvciBjb25maWcuaW5pdGlhbFBhblkuICBPciBqdXN0IHNldCBwYW56b29tQ29uZmlnLmluaXRpYWxab29tVG9GaXQnKTtcbiAgICAgIGNvbnNvbGUubG9nKCdjb25maWcuaW5pdGlhbFpvb21MZXZlbDogJyArIHRoaXMuY29uZmlnLmluaXRpYWxab29tTGV2ZWwpO1xuICAgICAgY29uc29sZS5sb2coJ2NvbmZpZy5pbml0aWFsUGFuWDogJyArIHRoaXMuY29uZmlnLmluaXRpYWxQYW5YKTtcbiAgICAgIGNvbnNvbGUubG9nKCdjb25maWcuaW5pdGlhbFBhblk6ICcgKyB0aGlzLmNvbmZpZy5pbml0aWFsUGFuWSk7XG4gICAgfVxuICB9XG5cblxuXG4gIHByaXZhdGUgem9vbVRvRml0KHJlY3RhbmdsZTogUmVjdCwgZHVyYXRpb24/OiBudW1iZXIpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogem9vbVRvRml0KCk6IHJlY3RhbmdsZScsIHJlY3RhbmdsZSk7XG5cbiAgICAvLyB3aGVuIGEgdXNlciBjbGlja3MgYSB6b29tIHRvIGZpdCBidXR0b25cbiAgICAvLyBleGFtcGxlIHJlY3RhbmdsZTogeyBcInhcIjogMCwgXCJ5XCI6IDEwMCwgXCJ3aWR0aFwiOiAxMDAsIFwiaGVpZ2h0XCI6IDEwMCB9XG5cbiAgICBjb25zdCB0YXJnZXQ6IFBhblpvb21Nb2RlbCA9IHRoaXMuY2FsY1pvb21Ub0ZpdChyZWN0YW5nbGUpO1xuICAgIC8vIHRhcmdldC5wYW4ueCBpcyB0aGUgcGFuRWxlbWVudCBsZWZ0IHN0eWxlIHByb3BlcnR5XG4gICAgLy8gdGFyZ2V0LnBhbi55IGlzIHRoZSBwYW5FbGVtZW50IHRvcCBzdHlsZSBwcm9wZXJ0eVxuICAgIHRoaXMubW9kZWwuaXNQYW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmFuaW1hdGVUb1RhcmdldCh0YXJnZXQsIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIHpvb21JblRvUG9pbnQoY2xpY2tQb2ludDogUG9pbnQpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogem9vbUluKCk6IGNsaWNrUG9pbnQ6JywgY2xpY2tQb2ludCk7XG4gICAgdGhpcy5jaGFuZ2Vab29tTGV2ZWwoIHRoaXMuYmFzZS56b29tTGV2ZWwgKyB0aGlzLmNvbmZpZy56b29tQnV0dG9uSW5jcmVtZW50LCBjbGlja1BvaW50ICk7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSB6b29tT3V0RnJvbVBvaW50KGNsaWNrUG9pbnQ6IFBvaW50KSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IHpvb21PdXQoKScpO1xuICAgIHRoaXMuY2hhbmdlWm9vbUxldmVsKCB0aGlzLmJhc2Uuem9vbUxldmVsIC0gdGhpcy5jb25maWcuem9vbUJ1dHRvbkluY3JlbWVudCwgY2xpY2tQb2ludCApO1xuICB9XG5cblxuXG4gIHByaXZhdGUgcGFuVG9Qb2ludChwb2ludDogUG9pbnQsIGR1cmF0aW9uPzogbnVtYmVyKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IHBhblRvUG9pbnQoKTogcG9pbnQ6JywgcG9pbnQpO1xuXG4gICAgLy8gQVBJIGNhbGwgdG8gYW5pbWF0ZSB0aGUgdmlldyBzbyB0aGF0IHRoZSBjZW50cmUgcG9pbnQgb2YgdGhlIHZpZXcgaXMgYXQgdGhlXG4gICAgLy8gcG9pbnQgcGFyYW1ldGVyIGNvb3JkaW5hdGVzLCByZWxhdGl2ZSB0byB0aGUgb3JpZ2luYWwsIHVuem9vbWVkXG4gICAgLy8gY29udGVudCB3aWR0aCBhbmQgaGVpZ2h0XG4gICAgLy8gZXhhbXBsZSBwb2ludDogeyBcInhcIjogMCwgXCJ5XCI6IDAgfSAvLyBtYWtlcyB0aGUgdG9wLWxlZnQgY29ybmVyIG9mIHRoZSBjb250ZW50XG4gICAgLy8gdGhlIGNlbnRyZSBvZiB0aGUgdmlld1xuXG4gICAgY29uc3QgdGFyZ2V0OiBQYW5ab29tTW9kZWwgPSB7XG4gICAgICBwYW46IHtcbiAgICAgICAgeDogKHRoaXMuZnJhbWVXaWR0aCAvIDIpIC0gcG9pbnQueCAqIHRoaXMuc2NhbGUsXG4gICAgICAgIHk6ICh0aGlzLmZyYW1lSGVpZ2h0IC8gMikgLSBwb2ludC55ICogdGhpcy5zY2FsZVxuICAgICAgfSxcbiAgICAgIHpvb21MZXZlbDogdGhpcy5iYXNlLnpvb21MZXZlbFxuICAgIH07XG4gICAgdGhpcy5tb2RlbC5pc1Bhbm5pbmcgPSB0cnVlO1xuICAgIHRoaXMuYW5pbWF0ZVRvVGFyZ2V0KHRhcmdldCwgZHVyYXRpb24pO1xuICB9XG5cblxuXG5cbiAgcHJpdmF0ZSBwYW5Ub1BvaW50Q3VycmVudFNjYWxlKHBvaW50OiBQb2ludCwgZHVyYXRpb24/OiBudW1iZXIpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnUGFuWm9vbUNvbXBvbmVudDogcGFuVG9Qb2ludCgpOiBwb2ludDonLCBwb2ludCk7XG5cbiAgICAvLyBBUEkgY2FsbCB0byBhbmltYXRlIHRoZSB2aWV3IHNvIHRoYXQgdGhlIGNlbnRyZSBwb2ludCBvZiB0aGUgdmlldyBpcyBhdCB0aGVcbiAgICAvLyBwb2ludCBwYXJhbWV0ZXIgY29vcmRpbmF0ZXMsIHJlbGF0aXZlIHRvIHRoZSBvcmlnaW5hbCwgdW56b29tZWRcbiAgICAvLyBjb250ZW50IHdpZHRoIGFuZCBoZWlnaHRcbiAgICAvLyBleGFtcGxlIHBvaW50OiB7IFwieFwiOiAwLCBcInlcIjogMCB9IC8vIG1ha2VzIHRoZSB0b3AtbGVmdCBjb3JuZXIgb2YgdGhlIGNvbnRlbnRcbiAgICAvLyB0aGUgY2VudHJlIG9mIHRoZSB2aWV3XG5cbiAgICBjb25zdCB0YXJnZXQ6IFBhblpvb21Nb2RlbCA9IHtcbiAgICAgIHBhbjoge1xuICAgICAgICB4OiAodGhpcy5mcmFtZVdpZHRoIC8gMikgLSBwb2ludC54LFxuICAgICAgICB5OiAodGhpcy5mcmFtZUhlaWdodCAvIDIpIC0gcG9pbnQueVxuICAgICAgfSxcbiAgICAgIHpvb21MZXZlbDogdGhpcy5iYXNlLnpvb21MZXZlbFxuICAgIH07XG4gICAgdGhpcy5tb2RlbC5pc1Bhbm5pbmcgPSB0cnVlO1xuICAgIHRoaXMuYW5pbWF0ZVRvVGFyZ2V0KHRhcmdldCwgZHVyYXRpb24pO1xuICB9XG5cblxuXG4gIHByaXZhdGUgcGFuRGVsdGEoZGVsdGE6IFBvaW50LCBkdXJhdGlvbj86IG51bWJlcikge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBwYW5EZWx0YSgpOiBkZWx0YTonLCBkZWx0YSk7XG5cbiAgICAvLyBBUEkgY2FsbCB0byBwYW4gdGhlIHZpZXcgbGVmdCwgcmlnaHQsIHVwLCBvciBkb3duLCBiYXNlZCBvbiBhIG51bWJlciBvZiBwaXhlbHNcbiAgICAvLyBvZiB0aGUgb3JpZ2luYWwsIHVuem9vbWVkIGNvbnRlbnQuXG4gICAgLy8gUG9zaXRpdmUgaXMgcmlnaHQgYW5kIGRvd25cbiAgICAvLyBOZWdhdGl2ZSBpcyBsZWZ0IGFuZCB1cFxuICAgIC8vIGV4YW1wbGUgcG9pbnQ6IHsgXCJ4XCI6IDEwMCwgXCJ5XCI6IC01MCB9IC8vIG1vdmVzIHRoZSB2aWV3IHJpZ2h0IDUwcHggYW5kIHVwIDUwcHhcblxuICAgIGNvbnN0IHRhcmdldDogUGFuWm9vbU1vZGVsID0ge1xuICAgICAgcGFuOiB7XG4gICAgICAgIHg6IHRoaXMuYmFzZS5wYW4ueCAtIHRoaXMuc2NhbGUgKiBkZWx0YS54LFxuICAgICAgICB5OiB0aGlzLmJhc2UucGFuLnkgLSB0aGlzLnNjYWxlICogZGVsdGEueVxuICAgICAgfSxcbiAgICAgIHpvb21MZXZlbDogdGhpcy5iYXNlLnpvb21MZXZlbFxuICAgIH07XG4gICAgdGhpcy5tb2RlbC5pc1Bhbm5pbmcgPSB0cnVlO1xuICAgIHRoaXMuYW5pbWF0ZVRvVGFyZ2V0KHRhcmdldCwgZHVyYXRpb24pO1xuICB9XG5cblxuXG4gIHByaXZhdGUgcGFuRGVsdGFBYnNvbHV0ZShkZWx0YTogUG9pbnQsIGR1cmF0aW9uPzogbnVtYmVyKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IHBhbkRlbHRhQWJzb2x1dGUoKTogZGVsdGE6JywgZGVsdGEpO1xuXG4gICAgLy8gQVBJIGNhbGwgdG8gcGFuIHRoZSB2aWV3IGxlZnQsIHJpZ2h0LCB1cCwgb3IgZG93biwgYmFzZWQgb24gYSBudW1iZXIgb2YgcGl4ZWxzXG4gICAgLy8gVGhpcyBtZXRob2QgZG9lc24ndCBhZGp1c3QgZm9yIHNjYWxlLiAgSSdtIG5vdCBzdXJlIHdoeSB5b3UnZCB3YW50IHRoaXNcbiAgICAvLyBidXQgaGF2ZSBpdCBoZXJlIGp1c3QgaW4gY2FzZSBzb21lb25lIG5lZWRzIGl0XG4gICAgLy8gUG9zaXRpdmUgaXMgcmlnaHQgYW5kIGRvd25cbiAgICAvLyBOZWdhdGl2ZSBpcyBsZWZ0IGFuZCB1cFxuICAgIC8vIGV4YW1wbGUgcG9pbnQ6IHsgXCJ4XCI6IDEwMCwgXCJ5XCI6IC01MCB9IC8vIG1vdmVzIHRoZSB2aWV3IHJpZ2h0IDUwcHggYW5kIHVwIDUwcHhcblxuICAgIGNvbnN0IHRhcmdldDogUGFuWm9vbU1vZGVsID0ge1xuICAgICAgcGFuOiB7XG4gICAgICAgIHg6IHRoaXMuYmFzZS5wYW4ueCAtIGRlbHRhLngsXG4gICAgICAgIHk6IHRoaXMuYmFzZS5wYW4ueSAtIGRlbHRhLnlcbiAgICAgIH0sXG4gICAgICB6b29tTGV2ZWw6IHRoaXMuYmFzZS56b29tTGV2ZWxcbiAgICB9O1xuICAgIHRoaXMubW9kZWwuaXNQYW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmFuaW1hdGVUb1RhcmdldCh0YXJnZXQsIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIHBhbkRlbHRhUGVyY2VudChkZWx0YVBlcmNlbnQ6IFBvaW50LCBkdXJhdGlvbj86IG51bWJlcikge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBwYW5EZWx0YVBlcmNlbnQoKTogZGVsdGFQZXJjZW50OicsIGRlbHRhUGVyY2VudCk7XG5cbiAgICAvLyBBUEkgY2FsbCB0byBwYW4gdGhlIHZpZXcgdXAsIGRvd24sIGxlZnQsIG9yIHJpZ2h0LCBiYXNlZCBvbiBhIHBlcmNlbnRhZ2VcbiAgICAvLyBvZiB0aGUgb3JpZ2luYWwsIHVuem9vbWVkIGNvbnRlbnQgd2lkdGggYW5kIGhlaWdodFxuICAgIC8vIGV4YW1wbGUgcG9pbnQ6IHsgXCJ4XCI6IDEwLCBcInlcIjogLTIwIH1cblxuICAgIGxldCBkZWx0YVggPSAwO1xuICAgIGxldCBkZWx0YVkgPSAwO1xuICAgIGlmIChkZWx0YVBlcmNlbnQueCAhPT0gMCkge1xuICAgICAgZGVsdGFYID0gdGhpcy5jb250ZW50V2lkdGggKiAoIGRlbHRhUGVyY2VudC54IC8gMTAwICkgKiB0aGlzLnNjYWxlO1xuICAgIH1cbiAgICBpZiAoZGVsdGFQZXJjZW50LnkgIT09IDApIHtcbiAgICAgIGRlbHRhWSA9IHRoaXMuY29udGVudEhlaWdodCAqICggZGVsdGFQZXJjZW50LnkgLyAxMDAgKSAqIHRoaXMuc2NhbGU7XG4gICAgfVxuXG4gICAgY29uc3QgdGFyZ2V0OiBQYW5ab29tTW9kZWwgPSB7XG4gICAgICBwYW46IHtcbiAgICAgICAgeDogdGhpcy5iYXNlLnBhbi54IC0gZGVsdGFYLFxuICAgICAgICB5OiB0aGlzLmJhc2UucGFuLnkgLSBkZWx0YVlcbiAgICAgIH0sXG4gICAgICB6b29tTGV2ZWw6IHRoaXMuYmFzZS56b29tTGV2ZWxcbiAgICB9O1xuICAgIC8vIHRhcmdldC5wYW4ueCBpcyB0aGUgcGFuRWxlbWVudCBsZWZ0IHN0eWxlIHByb3BlcnR5XG4gICAgLy8gdGFyZ2V0LnBhbi55IGlzIHRoZSBwYW5FbGVtZW50IHRvcCBzdHlsZSBwcm9wZXJ0eVxuICAgIHRoaXMubW9kZWwuaXNQYW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmFuaW1hdGVUb1RhcmdldCh0YXJnZXQsIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIGNlbnRlckNvbnRlbnQoZHVyYXRpb24/OiBudW1iZXIpIHtcbiAgICB0aGlzLnBhblRvUG9pbnQoIHtcbiAgICAgIHg6IHRoaXMuY29udGVudFdpZHRoIC8gMixcbiAgICAgIHk6IHRoaXMuY29udGVudEhlaWdodCAvIDJcbiAgICB9LFxuICAgIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIGNlbnRlclgoZHVyYXRpb24/OiBudW1iZXIpIHtcbiAgICBjb25zdCB0YXJnZXQ6IFBhblpvb21Nb2RlbCA9IHtcbiAgICAgIHBhbjoge1xuICAgICAgICB4OiAodGhpcy5mcmFtZVdpZHRoIC8gMikgLSAodGhpcy5jb250ZW50V2lkdGggLyAyKSAqIHRoaXMuc2NhbGUsXG4gICAgICAgIHk6IHRoaXMuYmFzZS5wYW4ueVxuICAgICAgfSxcbiAgICAgIHpvb21MZXZlbDogdGhpcy5iYXNlLnpvb21MZXZlbFxuICAgIH07XG4gICAgdGhpcy5tb2RlbC5pc1Bhbm5pbmcgPSB0cnVlO1xuICAgIHRoaXMuYW5pbWF0ZVRvVGFyZ2V0KHRhcmdldCwgZHVyYXRpb24pO1xuICB9XG5cblxuXG4gIHByaXZhdGUgY2VudGVyWShkdXJhdGlvbj86IG51bWJlcikge1xuICAgIGNvbnN0IHRhcmdldDogUGFuWm9vbU1vZGVsID0ge1xuICAgICAgcGFuOiB7XG4gICAgICAgIHg6IHRoaXMuYmFzZS5wYW4ueCxcbiAgICAgICAgeTogKHRoaXMuZnJhbWVIZWlnaHQgLyAyKSAtICh0aGlzLmNvbnRlbnRIZWlnaHQgLyAyKSAqIHRoaXMuc2NhbGVcbiAgICAgIH0sXG4gICAgICB6b29tTGV2ZWw6IHRoaXMuYmFzZS56b29tTGV2ZWxcbiAgICB9O1xuICAgIHRoaXMubW9kZWwuaXNQYW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmFuaW1hdGVUb1RhcmdldCh0YXJnZXQsIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIGNlbnRlclRvcExlZnRDb3JuZXIoZHVyYXRpb24/OiBudW1iZXIpIHtcbiAgICB0aGlzLnBhblRvUG9pbnQoIHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfSxcbiAgICBkdXJhdGlvbik7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBjZW50ZXJCb3R0b21MZWZ0Q29ybmVyKGR1cmF0aW9uPzogbnVtYmVyKSB7XG4gICAgdGhpcy5wYW5Ub1BvaW50KCB7XG4gICAgICB4OiAwLFxuICAgICAgeTogdGhpcy5jb250ZW50SGVpZ2h0XG4gICAgfSxcbiAgICBkdXJhdGlvbik7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBjZW50ZXJUb3BSaWdodENvcm5lcihkdXJhdGlvbj86IG51bWJlcikge1xuICAgIHRoaXMucGFuVG9Qb2ludCgge1xuICAgICAgeDogdGhpcy5jb250ZW50V2lkdGgsXG4gICAgICB5OiAwXG4gICAgfSxcbiAgICBkdXJhdGlvbik7XG4gIH1cblxuXG5cbiAgcHJpdmF0ZSBjZW50ZXJCb3R0b21SaWdodENvcm5lcihkdXJhdGlvbj86IG51bWJlcikge1xuICAgIHRoaXMucGFuVG9Qb2ludCgge1xuICAgICAgeDogdGhpcy5jb250ZW50V2lkdGgsXG4gICAgICB5OiB0aGlzLmNvbnRlbnRIZWlnaHRcbiAgICB9LFxuICAgIGR1cmF0aW9uKTtcbiAgfVxuXG5cblxuICBwcml2YXRlIHVwZGF0ZUNvbnRlbnREaW1lbnNpb25zKHdpZHRoPzogbnVtYmVyLCBoZWlnaHQ/OiBudW1iZXIpIHtcbiAgICBpZiAoaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuY29udGVudEhlaWdodCA9IGhlaWdodDtcbiAgICB9XG4gICAgaWYgKHdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuY29udGVudFdpZHRoID0gd2lkdGg7XG4gICAgfVxuICB9XG5cblxuXG4gIHByaXZhdGUgZGV0ZWN0Q29udGVudERpbWVuc2lvbnMoKSB7XG4gICAgY29uc3Qgem9vbUZyYW1lU3R5bGUgID0gZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnpvb21FbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgIHRoaXMuY29udGVudEhlaWdodCA9IHBhcnNlSW50KCB6b29tRnJhbWVTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKS5zcGxpdCgncHgnKVswXSApO1xuICAgIHRoaXMuY29udGVudFdpZHRoID0gcGFyc2VJbnQoIHpvb21GcmFtZVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3dpZHRoJykuc3BsaXQoJ3B4JylbMF0gKTtcbiAgfVxuXG5cblxuXG5cblxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEFOSU1BVElPTiBCVUlMREVSUyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuXG4gIHByaXZhdGUgYW5pbWF0ZVRvVGFyZ2V0KHRhcmdldE1vZGVsOiBQYW5ab29tTW9kZWwsIGR1cmF0aW9uID0gdW5kZWZpbmVkKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1Bhblpvb21Db21wb25lbnQ6IGFuaW1hdGVUb1RhcmdldCgpJyk7XG4gICAgLy8gd2hhdCB0aGlzIGZ1bmN0aW9uIHJlYWxseSBkb2VzIGlzIHRha2UgYSB0YXJnZXQgbW9kZWwsIGFuZCB0aGVuIHNldHNcbiAgICAvLyB0aGlzLmFuaW1hdGlvblBhcmFtcyB3aXRoIHRoZSBwYXJhbWV0ZXJzIGZvciB0aGUgd2hvbGUgYW5pbWF0aW9uLFxuICAgIC8vIG5hbWVseSB0aGUgZGVsdGEgem9vbUxldmVsXG4gICAgLy8gaXQgaXMgdGhlIHJlc3BvbnNpYmlsaXR5IG9mIHRoZSBjYWxsZXIgdG8ga2ljayBvZmYgdGhlIGFuaW1hdGlvbiB3aXRoIGEgY2FsbCB0byBhbmltYXRpb25GcmFtZUZ1bmMoKVxuXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICAvLyBtYWtlIHRoZSB1c2VyIHdhaXQgZm9yIGV4aXN0aW5nIGFuaW1hdGlvbiB0byBmaW5pc2ggYmVmb3JlIGNsaWNraW5nXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy56b29tTGV2ZWxJc0NoYW5naW5nID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuYmFzZS56b29tTGV2ZWwgIT09IHRhcmdldE1vZGVsLnpvb21MZXZlbCkge1xuICAgICAgdGhpcy56b29tTGV2ZWxJc0NoYW5naW5nID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWx0YVpvb21MZXZlbCA9IHRhcmdldE1vZGVsLnpvb21MZXZlbCAtIHRoaXMuYmFzZS56b29tTGV2ZWw7IC8vIGRlbHRhWm9vbUxldmVsIGlzIHRoZSBudW1iZXIgb2Ygem9vbSBsZXZlbHMgd2UgYXJlIGNoYW5naW5nIGhlcmVcblxuICAgIGNvbnN0IG9sZEJhc2U6IFBvaW50ID0ge1xuICAgICAgLy8gdGhlIGN1cnJlbnQgYmFzZSBjb29yZGluYXRlc1xuICAgICAgeDogdGhpcy5iYXNlLnBhbi54LFxuICAgICAgeTogdGhpcy5iYXNlLnBhbi55XG4gICAgfTtcbiAgICB0aGlzLm1vZGVsLnBhbi54ID0gdGhpcy5iYXNlLnBhbi54O1xuICAgIHRoaXMubW9kZWwucGFuLnkgPSB0aGlzLmJhc2UucGFuLnk7XG5cbiAgICBjb25zdCBwYW5TdGVwRnVuYyA9ICh6b29tTGV2ZWw6IG51bWJlcikgPT4ge1xuICAgICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCBkdXJpbmcgZXZlcnkgYW5pbWF0aW9uIHRpY2sgaW4gdXBkYXRlRE9NKCksIHRvIGNhbGN1bGF0ZSB3aGVyZSB0byBtb3ZlIHRoZSBtb2RlbCBwYW4gY29vcmRpbmF0ZXMgdG8gKGkuZS4gdGhlIHRyYW5zbGF0aW9uKSBmb3IgdGhhdCB0aWNrLCB6b29tTGV2ZWwgaXMgaWdub3JlZCB3aXRoaW4gYW5pbWF0ZVRvVGFyZ2V0KClcbiAgICAgIGNvbnN0IHRhcmdldFBvaW50OiBQb2ludCA9IHtcbiAgICAgICAgLy8gVGhlIHRhcmdldCBwb2ludCB0byB6b29tIHRvIGZvciB0aGUgY3VycmVudCBhbmltYXRpb24gZnJhbWUuICBJdCBtdXN0IHN0YXkgdGhlIHNhbWUgYXMgdGhlIHVudHJhbnNsYXRlZCBwb2ludFxuICAgICAgICB4OiAob2xkQmFzZS54IC0gdGFyZ2V0TW9kZWwucGFuLngpICogdGhpcy5hbmltYXRpb25QYXJhbXMucHJvZ3Jlc3MsXG4gICAgICAgIHk6IChvbGRCYXNlLnkgLSB0YXJnZXRNb2RlbC5wYW4ueSkgKiB0aGlzLmFuaW1hdGlvblBhcmFtcy5wcm9ncmVzc1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeDogLXRhcmdldFBvaW50LngsXG4gICAgICAgIHk6IC10YXJnZXRQb2ludC55XG4gICAgICB9O1xuICAgIH07XG5cbiAgICAvLyBub3cgc2V0IHRoZSBwYXJhbWV0ZXJzIG9mIG91ciBuZXcgYW5pbWF0aW9uXG4gICAgZHVyYXRpb24gPSBkdXJhdGlvbiA/IGR1cmF0aW9uICogMTAwMCA6IHRoaXMuY29uZmlnLnpvb21TdGVwRHVyYXRpb24gKiAxMDAwO1xuICAgIHRoaXMuYW5pbWF0aW9uUGFyYW1zID0ge1xuICAgICAgZGVsdGFab29tTGV2ZWw6IGRlbHRhWm9vbUxldmVsLCAvLyBob3cgbWFueSB6b29vbSBsZXZlbHMgdG8gem9vbSBpbiBvciBvdXRcbiAgICAgIHBhblN0ZXBGdW5jOiBwYW5TdGVwRnVuYywgLy8gYSBmdW5jdGlvbiB3aGljaCBydW5zIG9uIGV2ZXJ5IGFuaW1hdGlvbiB0aWNrLCB3aGljaCBjYWxjcyBob3cgbXVjaCB0byBwYW4gdGhlIHZpZXcgb24gZXZlcnkgZnJhbWVcbiAgICAgIGR1cmF0aW9uLCAvLyBob3cgbG9uZyB0aGUgYW5pbWF0aW9uIHNob3VsZCB0YWtlXG4gICAgICBwcm9ncmVzczogMC4wXG4gICAgfTtcblxuICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICB9XG5cblxuXG4gIHByaXZhdGUgY2hhbmdlWm9vbUxldmVsKG5ld1pvb21MZXZlbDogbnVtYmVyLCBjbGlja1BvaW50OiBQb2ludCkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdQYW5ab29tQ29tcG9uZW50OiBjaGFuZ2Vab29tTGV2ZWwoKScpO1xuXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uUGFyYW1zKSB7XG4gICAgICAvLyBsZXQncyBsZXQgYW55IGN1cnJlbnQgYW5pbWF0aW9uIGp1c3QgZmluaXNoXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy56b29tTGV2ZWxJc0NoYW5naW5nID0gdHJ1ZTtcblxuICAgIC8vIGtlZXAgem9vbSBsZXZlbCBpbiBib3VuZHNcbiAgICBuZXdab29tTGV2ZWwgPSBNYXRoLm1heCh0aGlzLm1pbmltdW1BbGxvd2VkWm9vbUxldmVsLCBuZXdab29tTGV2ZWwpO1xuICAgIG5ld1pvb21MZXZlbCA9IE1hdGgubWluKHRoaXMuY29uZmlnLnpvb21MZXZlbHMgLSAxLCBuZXdab29tTGV2ZWwpO1xuICAgIC8vIGNvbnNvbGUubG9nKCduZXdab29tTGV2ZWw6JywgbmV3Wm9vbUxldmVsKTtcblxuICAgIGNvbnN0IGRlbHRhWm9vbUxldmVsID0gbmV3Wm9vbUxldmVsIC0gdGhpcy5iYXNlLnpvb21MZXZlbDsgLy8gZGVsdGFab29tTGV2ZWwgaXMgdGhlIG51bWJlciBvZiB6b29tIGxldmVscyB3ZSBhcmUgY2hhbmdpbmcgaGVyZVxuICAgIGlmICghZGVsdGFab29tTGV2ZWwpIHtcbiAgICAgIC8vIGEgZGVsdGFab29tTGV2ZWwgb2YgemVybyBtZWFucyB0aGF0IHdlIGFyZW4ndCBjaGFuZ2luZyB6b29tLCBiZWNhdXNlIHdlJ3JlIGVpdGhlciB6b29tZWQgYWxsIHRoZSB3YXkgaW4gb3IgYWxsIHRoZSB3YXkgb3V0XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy9cbiAgICAvLyBMZXQgcCBiZSB0aGUgdmVjdG9yIHRvIHRoZSBjbGlja2VkIHBvaW50IGluIHZpZXcgY29vcmRzIGFuZCBsZXQgcCcgYmUgdGhlIHNhbWUgcG9pbnQgaW4gbW9kZWwgY29vcmRzLiBMZXQgcyBiZSBhIHNjYWxlIGZhY3RvclxuICAgIC8vIGFuZCBsZXQgdCBiZSBhIHRyYW5zbGF0aW9uIHZlY3Rvci4gTGV0IHRoZSB0cmFuc2Zvcm1hdGlvbiBiZSBkZWZpbmVkIGFzOlxuICAgIC8vXG4gICAgLy8gIHAnID0gcCAqIHMgKyB0XG4gICAgLy9cbiAgICAvLyBBbmQgY29udmVyc2VseTpcbiAgICAvL1xuICAgIC8vICBwID0gKDEvcykocCcgLSB0KVxuICAgIC8vXG4gICAgLy8gTm93IHVzZSBzdWJzY3JpcHRpb24gMCB0byBkZW5vdGUgdGhlIHZhbHVlIGJlZm9yZSB0cmFuc2Zvcm0gYW5kIHpvb20gYW5kIGxldCAxIGRlbm90ZSB0aGUgdmFsdWUgYWZ0ZXIgdHJhbnNmb3JtLiBTY2FsZVxuICAgIC8vIGNoYW5nZXMgZnJvbSBzMCB0byBzMS4gVHJhbnNsYXRpb24gY2hhbmdlcyBmcm9tIHQwIHRvIHQxLiBCdXQga2VlcCBwIGFuZCBwJyBmaXhlZCBzbyB0aGF0IHRoZSB2aWV3IGNvb3JkaW5hdGUgcCcgc3RpbGxcbiAgICAvLyBjb3JyZXNwb25kcyB0byB0aGUgbW9kZWwgY29vcmRpbmF0ZSBwLiBUaGlzIGNhbiBiZSBleHByZXNzZWQgYXMgYW4gZXF1YXRpb24gcmVseWluZyB1cG9uIHNvbGVseSB1cG9uIHAnLCBzMCwgczEsIHQwLCBhbmQgdDE6XG4gICAgLy9cbiAgICAvLyAgKDEvczApKHAgLSB0MCkgPSAoMS9zMSkocCAtIHQxKVxuICAgIC8vXG4gICAgLy8gRXZlcnkgdmFyaWFibGUgYnV0IHQxIGlzIGtub3duLCB0aHVzIGl0IGlzIGVhc2lseSBpc29sYXRlZCB0bzpcbiAgICAvL1xuICAgIC8vICB0MSA9IHAnIC0gKHMxL3MwKSoocCcgLSB0MClcbiAgICAvL1xuXG4gICAgY29uc3QgY3VycmVudFBhbjogUG9pbnQgPSB7XG4gICAgICAvLyB0MCAtIHRoZSBjdXJyZW50IGJhc2UgY29vcmRpbmF0ZXNcbiAgICAgIHg6IHRoaXMuYmFzZS5wYW4ueCxcbiAgICAgIHk6IHRoaXMuYmFzZS5wYW4ueVxuICAgIH07XG5cbiAgICBjb25zdCBjdXJyZW50U2NhbGUgPSB0aGlzLnNjYWxlOyAvLyBzMCAtIGdldCB0aGUgY3VycmVudCBDU1Mgc2NhbGUgKHNjYWxlMClcbiAgICBjb25zdCBkZXN0UG9pbnQgPSBjbGlja1BvaW50IHx8IHRoaXMuZ2V0Q2VudHJlUG9pbnQoKTsgLy8gcG1hcmsgLSB0aGUgcG9pbnQgd2UgYXJlIGFpbWluZyB0byB6b29tIHRvIChlaXRoZXIgdGhlIGNsaWNrIHBvaW50IG9yIHRoZSBjZW50cmUgb2YgdGhlIHBhZ2UpXG5cblxuICAgIGNvbnN0IHBhblN0ZXBGdW5jID0gKHpvb21MZXZlbDogbnVtYmVyKSA9PiB7XG4gICAgICAvLyB0aGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGR1cmluZyBldmVyeSBhbmltYXRpb24gdGljaywgdG8gY2FsY3VsYXRlIHdoZXJlIHRvIG1vdmUgdGhlIG1vZGVsIHBhbiBjb29yZGluYXRlcyB0byAoaS5lLiB0aGUgdHJhbnNsYXRpb24pIGZvciB0aGF0IHRpY2ssIHdoZXJlIHpvb21MZXZlbCBpcyBjYWxjdWxhdGVkIGZyb20gdGhlIGN1cnJlbnQgem9vbUxldmVsICsgdGhlIHRhcmdldCB6b29tTGV2ZWwgKiB0aGUgcHJvZ3Jlc3Mgb2YgdGhlIGN1cnJlbnQgYW5pbWF0aW9uXG5cbiAgICAgIGNvbnN0IHRhcmdldFNjYWxlID0gdGhpcy5nZXRDc3NTY2FsZSh6b29tTGV2ZWwpOyAvLyBzMSAtIHRoZSBzY2FsZSB0byB0cmFuc2xhdGUgdG8gZm9yIHRoZSBjdXJyZW50IGFuaW1hdGlvbiB0aWNrXG4gICAgICBjb25zdCB0YXJnZXRQb2ludDogUG9pbnQgPSB7XG4gICAgICAgIC8vIHQxIC0gVGhlIHRhcmdldCBwb2ludCB0byBwYW4gdG8uICBJdCBtdXN0IHN0YXkgdGhlIHNhbWUgYXMgdGhlIHVudHJhbnNsYXRlZCBwb2ludFxuICAgICAgICB4OiBkZXN0UG9pbnQueCAtICh0YXJnZXRTY2FsZSAvIGN1cnJlbnRTY2FsZSkgKiAoZGVzdFBvaW50LnggLSBjdXJyZW50UGFuLngpLFxuICAgICAgICB5OiBkZXN0UG9pbnQueSAtICh0YXJnZXRTY2FsZSAvIGN1cnJlbnRTY2FsZSkgKiAoZGVzdFBvaW50LnkgLSBjdXJyZW50UGFuLnkpXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAvLyBub3cgcmV0dXJuIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gb3VyIGluaXRpYWwgY2xpY2sgcG9pbnQgYW5kIG91ciB0cmFuc2xhdGVkICh6b29tZWQpIGNsaWNrIHBvaW50XG4gICAgICAgIC8vIHRoZXNlIGFyZSBub3QgYWJzb2x1dGUgY29vcmRpbmF0ZXMgLSBqdXN0IGhvdyBmYXIgdG8gbW92ZSB0aGVtXG4gICAgICAgIHg6IHRhcmdldFBvaW50LnggLSBjdXJyZW50UGFuLngsXG4gICAgICAgIHk6IHRhcmdldFBvaW50LnkgLSBjdXJyZW50UGFuLnlcbiAgICAgIH07XG4gICAgfTtcblxuICAgIC8vIG5vdyBzZXQgdGhlIHBhcmFtZXRlcnMgb2Ygb3VyIG5ldyBhbmltYXRpb25cbiAgICB0aGlzLmFuaW1hdGlvblBhcmFtcyA9IHtcbiAgICAgIGRlbHRhWm9vbUxldmVsOiBkZWx0YVpvb21MZXZlbCwgLy8gdGhlIGRlc3RpbmF0aW9uIHpvb20gbGV2ZWwgZm9yIHRoaXMgem9vbSBvcGVyYXRpb24gKHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZWQpXG4gICAgICBwYW5TdGVwRnVuYzogcGFuU3RlcEZ1bmMsXG4gICAgICBkdXJhdGlvbjogdGhpcy5jb25maWcuem9vbVN0ZXBEdXJhdGlvbiAqIDEwMDAsIC8vIGhvdyBsb25nIHRoZSBhbmltYXRpb24gc2hvdWxkIHRha2VcbiAgICAgIHByb2dyZXNzOiAwLjBcbiAgICB9O1xuICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICB9XG5cblxuXG59XG4iLCI8ZGl2XG4gICNmcmFtZUVsZW1lbnRcbiAgY2xhc3M9XCJwYW4tem9vbS1mcmFtZVwiPlxuXG4gICAgPGRpdlxuICAgICAgI3BhbkVsZW1lbnRcbiAgICAgIGNsYXNzPVwicGFuLWVsZW1lbnRcIj5cblxuICAgICAgICA8ZGl2XG4gICAgICAgICAgI3pvb21FbGVtZW50XG4gICAgICAgICAgY2xhc3M9XCJ6b29tLWVsZW1lbnRcIj5cblxuICAgICAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuXG4gICAgICAgIDwvZGl2PlxuXG4gICAgPC9kaXY+XG5cbjwvZGl2PlxuXG48ZGl2XG4gICNwYW56b29tT3ZlcmxheVxuICBjbGFzcz1cInBhbi16b29tLW92ZXJsYXlcIj5cbjwvZGl2PiJdfQ==